<!DOCTYPE html><html lang="ko"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>데이터 중심 어플리케이션 설계 - 7장 트랜잭션 | Choi's Dev</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-203671947-1','auto');ga('send','pageview');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">데이터 중심 어플리케이션 설계 - 7장 트랜잭션</h1><a id="logo" href="/.">Choi's Dev</a><p class="description">Software Engineer, Backend-Developer</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 홈</i></a><a href="/archives/"><i class="fa fa-archive"> 아카이브</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">데이터 중심 어플리케이션 설계 - 7장 트랜잭션</h1><div class="post-meta">2021-08-09<span> | </span><span class="category"><a href="/categories/ARCHITECTURE/">ARCHITECTURE</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">컨텐츠</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98%EA%B3%BC-%ED%98%84%EC%8B%A4-%EC%84%B8%EA%B3%84%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B2%A0%EC%9D%B4%EC%8A%A4"><span class="toc-number">1.</span> <span class="toc-text">트랜잭션과 현실 세계의 데이터 베이스</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EB%AA%A8%ED%98%B8%ED%95%9C-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EA%B0%9C%EB%85%90"><span class="toc-number">2.</span> <span class="toc-text">모호한 트랜잭션 개념</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ACID"><span class="toc-number">2.1.</span> <span class="toc-text">ACID</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%9B%90%EC%9E%90%EC%84%B1-Atomicity"><span class="toc-number">2.1.1.</span> <span class="toc-text">원자성(Atomicity)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%9D%BC%EA%B4%80%EC%84%B1-Consistency"><span class="toc-number">2.1.2.</span> <span class="toc-text">일관성(Consistency)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EA%B2%A9%EB%A6%AC%EC%84%B1-Isolation"><span class="toc-number">2.1.3.</span> <span class="toc-text">격리성(Isolation)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%A7%80%EC%86%8D%EC%84%B1-Durability"><span class="toc-number">2.1.4.</span> <span class="toc-text">지속성(Durability)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EB%8B%A8%EC%9D%BC-%EB%8B%A4%EC%A4%91-%EA%B0%9D%EC%B2%B4-%EC%97%B0%EC%82%B0"><span class="toc-number">2.2.</span> <span class="toc-text">단일&#x2F;다중 객체 연산</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EB%8B%A4%EC%A4%91-%EA%B0%9D%EC%B2%B4-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98%EC%9D%98-%ED%95%84%EC%9A%94%EC%84%B1"><span class="toc-number">2.3.</span> <span class="toc-text">다중 객체 트랜잭션의 필요성</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%98%A4%EB%A5%98%EC%99%80-%EC%96%B4%EB%B3%B4%ED%8A%B8-%EC%B2%98%EB%A6%AC"><span class="toc-number">2.4.</span> <span class="toc-text">오류와 어보트 처리</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EC%99%84%ED%99%94%EB%90%9C-%EA%B2%A9%EB%A6%AC-%EC%88%98%EC%A4%80"><span class="toc-number">3.</span> <span class="toc-text">완화된 격리 수준</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%BB%A4%EB%B0%8B-%ED%9B%84-%EC%9D%BD%EA%B8%B0-READ-COMMITTED"><span class="toc-number">3.1.</span> <span class="toc-text">커밋 후 읽기(READ COMMITTED)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EB%8D%94%ED%8B%B0-%EC%9D%BD%EA%B8%B0-%EB%B0%A9%EC%A7%80"><span class="toc-number">3.1.1.</span> <span class="toc-text">더티 읽기 방지</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EB%8D%94%ED%8B%B0-%EC%93%B0%EA%B8%B0-%EB%B0%A9%EC%A7%80"><span class="toc-number">3.1.2.</span> <span class="toc-text">더티 쓰기 방지</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%BB%A4%EB%B0%8B-%ED%9B%84-%EC%9D%BD%EA%B8%B0-READ-COMMITTED-%EA%B5%AC%ED%98%84"><span class="toc-number">3.1.3.</span> <span class="toc-text">커밋 후 읽기(READ_COMMITTED) 구현</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%8A%A4%EB%83%85%EC%83%B7-%EA%B2%A9%EB%A6%AC%EC%99%80-%EB%B0%98%EB%B3%B5-%EC%9D%BD%EA%B8%B0"><span class="toc-number">3.2.</span> <span class="toc-text">스냅샷 격리와 반복 읽기</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%8A%A4%EB%83%85%EC%83%B7-%EA%B2%A9%EB%A6%AC-%EA%B5%AC%ED%98%84"><span class="toc-number">3.2.1.</span> <span class="toc-text">스냅샷 격리 구현</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%9D%BC%EA%B4%80%EB%90%9C-%EC%8A%A4%EB%83%85%EC%83%B7%EC%9D%84-%EB%B3%B4%EB%8A%94-%EA%B0%80%EC%8B%9C%EC%84%B1-%EA%B7%9C%EC%B9%99"><span class="toc-number">3.2.2.</span> <span class="toc-text">일관된 스냅샷을 보는 가시성 규칙</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%83%89%EC%9D%B8%EA%B3%BC-%EC%8A%A4%EB%83%85%EC%83%B7-%EA%B2%A9%EB%A6%AC"><span class="toc-number">3.2.3.</span> <span class="toc-text">색인과 스냅샷 격리</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EB%B0%98%EB%B3%B5-%EC%9D%BD%EA%B8%B0%EC%99%80-%ED%98%BC%EB%9E%80%EC%8A%A4%EB%9F%AC%EC%9A%B4-%EC%9D%B4%EB%A6%84"><span class="toc-number">3.2.4.</span> <span class="toc-text">반복 읽기와 혼란스러운 이름</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EA%B0%B1%EC%8B%A0-%EC%86%90%EC%8B%A4-%EB%B0%A9%EC%A7%80"><span class="toc-number">3.3.</span> <span class="toc-text">갱신 손실 방지</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%9B%90%EC%9E%90%EC%A0%81-%EC%93%B0%EA%B8%B0-%EC%97%B0%EC%82%B0"><span class="toc-number">3.3.1.</span> <span class="toc-text">원자적 쓰기 연산</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EB%AA%85%EC%8B%9C%EC%A0%81%EC%9D%B8-%EC%9E%A0%EA%B8%88"><span class="toc-number">3.3.2.</span> <span class="toc-text">명시적인 잠금</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EA%B0%B1%EC%8B%A0-%EC%86%90%EC%8B%A4-%EC%9E%90%EB%8F%99-%EA%B0%90%EC%A7%80"><span class="toc-number">3.3.3.</span> <span class="toc-text">갱신 손실 자동 감지</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Compare-And-Set"><span class="toc-number">3.3.4.</span> <span class="toc-text">Compare-And-Set</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%B6%9C%EB%8F%99-%ED%95%B4%EC%86%8C%EC%99%80-%EB%B3%B5%EC%A0%9C"><span class="toc-number">3.3.5.</span> <span class="toc-text">출동 해소와 복제</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%93%B0%EA%B8%B0-%EC%8A%A4%ED%81%90%EC%99%80-%ED%8C%AC%ED%85%80"><span class="toc-number">3.4.</span> <span class="toc-text">쓰기 스큐와 팬텀</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%93%B0%EA%B8%B0-%EC%8A%A4%ED%81%90%EB%A5%BC-%ED%8A%B9%EC%A0%95%EC%A7%93%EA%B8%B0"><span class="toc-number">3.4.1.</span> <span class="toc-text">쓰기 스큐를 특정짓기</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%93%B0%EA%B8%B0-%EC%8A%A4%ED%81%90%EB%A5%BC-%EC%9C%A0%EB%B0%9C%ED%95%98%EB%8A%94-%ED%8C%A8%ED%84%B4"><span class="toc-number">3.4.2.</span> <span class="toc-text">쓰기 스큐를 유발하는 패턴</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%B6%A9%EB%8F%8C-%EA%B5%AC%EC%B2%B4%ED%99%94"><span class="toc-number">3.4.3.</span> <span class="toc-text">충돌 구체화</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EC%A7%81%EB%A0%AC%EC%84%B1"><span class="toc-number">4.</span> <span class="toc-text">직렬성</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%8B%A4%EC%A0%9C%EC%A0%81%EC%9D%B8-%EC%A7%81%EB%A0%AC-%EC%8B%A4%ED%96%89"><span class="toc-number">4.1.</span> <span class="toc-text">실제적인 직렬 실행</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98%EC%9D%84-%EC%8A%A4%ED%86%A0%EC%96%B4%EB%93%9C-%ED%94%84%EB%A1%9C%EC%8B%9C%EC%A0%80-%EC%95%88%EC%97%90-%EC%BA%A1%EC%8A%90%ED%99%94%ED%95%98%EA%B8%B0"><span class="toc-number">4.1.1.</span> <span class="toc-text">트랜잭션을 스토어드 프로시저 안에 캡슐화하기</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%8A%A4%ED%86%A0%EC%96%B4%EB%93%9C-%ED%94%84%EB%A1%9C%EC%8B%9C%EC%A0%80%EC%9D%98-%EC%9E%A5%EB%8B%A8%EC%A0%90"><span class="toc-number">4.1.2.</span> <span class="toc-text">스토어드 프로시저의 장단점</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9D"><span class="toc-number">4.1.3.</span> <span class="toc-text">파티셔닝</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%A7%81%EB%A0%AC-%EC%8B%A4%ED%96%89-%EC%9A%94%EC%95%BD"><span class="toc-number">4.1.4.</span> <span class="toc-text">직렬 실행 요약</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EB%8B%A8%EA%B3%84-%EC%9E%A0%EA%B8%88"><span class="toc-number">4.2.</span> <span class="toc-text">2단계 잠금</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EB%8B%A8%EA%B3%84-%EC%9E%A0%EA%B8%88-%EA%B5%AC%ED%98%84"><span class="toc-number">4.2.1.</span> <span class="toc-text">2단계 잠금 구현</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EB%8B%A8%EA%B3%84-%EC%9E%A0%EA%B8%88%EC%9D%98-%EC%84%B1%EB%8A%A5"><span class="toc-number">4.2.2.</span> <span class="toc-text">2단계 잠금의 성능</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%84%9C%EC%88%A0-%EC%9E%A0%EA%B8%88-Predicate-Lock"><span class="toc-number">4.2.3.</span> <span class="toc-text">서술 잠금(Predicate Lock)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%83%89%EC%9D%B8-%EB%B2%94%EC%9C%84-%EC%9E%A0%EA%B8%88"><span class="toc-number">4.2.4.</span> <span class="toc-text">색인 범위 잠금</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%A7%81%EB%A0%AC%EC%84%B1-%EC%8A%A4%EB%83%85%EC%83%B7-%EA%B2%A9%EB%A6%AC-SSI"><span class="toc-number">4.3.</span> <span class="toc-text">직렬성 스냅샷 격리(SSI)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EB%B9%84%EA%B4%80%EC%84%B1-%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%A0%9C%EC%96%B4%EC%99%80-%EB%82%99%EA%B4%80%EC%A0%81-%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%A0%9C%EC%96%B4"><span class="toc-number">4.3.1.</span> <span class="toc-text">비관성 동시성 제어와 낙관적 동시성 제어</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EB%92%A4%EC%B3%90%EC%A7%84-%EC%A0%84%EC%A0%9C%EC%97%90-%EA%B8%B0%EB%B0%98%ED%95%9C-%EA%B2%B0%EC%A0%95"><span class="toc-number">4.3.2.</span> <span class="toc-text">뒤쳐진 전제에 기반한 결정</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%98%A4%EB%9E%98%EB%90%9C-MVCC-%EC%9D%BD%EA%B8%B0-%EA%B0%90%EC%A7%80%ED%95%98%EA%B8%B0"><span class="toc-number">4.3.3.</span> <span class="toc-text">오래된 MVCC 읽기 감지하기</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EA%B3%BC%EA%B1%B0%EC%9D%98-%EC%9D%BD%EA%B8%B0%EC%97%90-%EC%98%81%ED%96%A5%EC%9D%84-%EB%AF%B8%EC%B9%98%EB%8A%94-%EC%93%B0%EA%B8%B0-%EA%B0%90%EC%A7%80%ED%95%98%EA%B8%B0"><span class="toc-number">4.3.4.</span> <span class="toc-text">과거의 읽기에 영향을 미치는 쓰기 감지하기</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EC%A7%81%EB%A0%AC%EC%84%B1-%EC%8A%A4%EB%83%85%EC%83%B7-%EA%B2%A9%EB%A6%AC%EC%9D%98-%EC%84%B1%EB%8A%A5"><span class="toc-number">4.3.5.</span> <span class="toc-text">직렬성 스냅샷 격리의 성능</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EC%A0%95%EB%A6%AC"><span class="toc-number">5.</span> <span class="toc-text">정리</span></a></li></ol></div></div><div class="post-content"><blockquote>
<p>트랜잭션 없이 코딩하는 것보다 트랜잭션을 과용해서 병목지점이 생기는 성능 문제를 애플리케이션 프로그래머가 처리하게 하는 게 낫다고 생각한다.</p>
</blockquote>
<h2 id="트랜잭션과-현실-세계의-데이터-베이스"><a href="#트랜잭션과-현실-세계의-데이터-베이스" class="headerlink" title="트랜잭션과 현실 세계의 데이터 베이스"></a>트랜잭션과 현실 세계의 데이터 베이스</h2><ul>
<li>어플리케이션에서 몇 개의 읽기와 쓰기를 하나의 논리적 단위로 묶는 방법</li>
<li>프로그래밍 모델의 단순화 목적이며 잠재적 오류 / 동시성 문제를 무시할 수 있다.</li>
<li>트랜잭션이 매번 필요한 것은 아니며 보장을 완화하거나 아예 안쓰는게 이득일 수 있다.</li>
<li>S/W, H/W는 언제라도 실패할 수 있다</li>
<li>어플리케이션은 언제라도 죽을 수 있다</li>
<li>네트워크 문제가 생기면 데이터베이스 노드 사이의 통신이 안될 수 있다</li>
<li>동시에 쓰기를 실행하면 다른 클라이언트가 쓴 내용을 덮어쓸 수 있다.</li>
<li>비정상적인 데이터를 읽을 수 있다.</li>
<li>예측하지 못한 버그를 유발할 수 있다.</li>
</ul>
<h2 id="모호한-트랜잭션-개념"><a href="#모호한-트랜잭션-개념" class="headerlink" title="모호한 트랜잭션 개념"></a>모호한 트랜잭션 개념</h2><ul>
<li>새로운 세대의 데이터베이스 중 다수는 트랜잭션을 완전히 포기하거나 과거에 인식되던 것보다 훨씬 약한 보장을 의미하는 단어로 재정의</li>
<li>기존 DB 벤더들은 트랜잭션 보장을 “값진 데이터”가 있는 “중요 어플리케이션”에 필수적인 요구사항이라고 이야기하고 있음</li>
</ul>
<h3 id="ACID"><a href="#ACID" class="headerlink" title="ACID"></a>ACID</h3><ul>
<li>원자성(Atomicity), 일관성(Consistency), 격리성(Isolation), 지속성(Durability)</li>
<li>데이터베이스마다 ACID에 대한 구현은 제각각<blockquote>
<p>상위 수준의 아이디어는 비슷/견실하지만 악마는 세부사항에 있다.</p>
</blockquote>
</li>
<li>기본적으로 가용성을 제공하고, 유연한 상태를 가지며 최종적 일관성을 지니는 뜻으로 사용</li>
</ul>
<h4 id="원자성-Atomicity"><a href="#원자성-Atomicity" class="headerlink" title="원자성(Atomicity)"></a>원자성(Atomicity)</h4><ul>
<li>더 이상 쪼갤 수 없는 무엇인가를 가리킴<blockquote>
<p>Multi Thread Model에서 하나의 스레드가 원자적 연산을 실행하면 다른 스레드에서 중간 상태를 관찰할 수 없고 실행 전 혹은 실행 후만 관찰 가능</p>
</blockquote>
</li>
<li>여러 쓰기 작업이 Atomic 하게 묶여 있을때 결함으로 커밋을 할수 없다면 어보트되고 데이터베이스는 지금까지 실행한 쓰기를 모두 무시/취소해야 함. ACID 원자성의 결정적인 특징이다.</li>
</ul>
<h4 id="일관성-Consistency"><a href="#일관성-Consistency" class="headerlink" title="일관성(Consistency)"></a>일관성(Consistency)</h4><ul>
<li>데이터 관한 어떤 선언(불변식)<ul>
<li>FK, PK와 같은 제약 조건</li>
</ul>
</li>
<li>일관성을 유지하도록 트랜잭션을 올바르게 정의하는 것은 애플리케이션의 책임</li>
<li><em><strong>원자성, 격리성, 지속성은 데이터베이스의 속성인 반면 일관성은 애플리케이션의 속성</strong></em></li>
</ul>
<h4 id="격리성-Isolation"><a href="#격리성-Isolation" class="headerlink" title="격리성(Isolation)"></a>격리성(Isolation)</h4><ul>
<li>동시에 실행되는 트랜잭션은 서로 격리되는 것을 의미. 다시 말해, 동시에 실행되는 트랜잭션들은 서로 방해하지 말아야 한다.</li>
<li>데이터베이스는 실제로는 여러 트랜잭션이 동시에 실행됐더라도 트랜잭션이 커밋됐을 때의 결과가 트랜잭션이 순차적으로 실행됐을 때의 결과와 동일하도록 보장</li>
<li>직렬성 격리는 성능 손해를 동반하므로 현실에서는 거의 사용을 안한다.</li>
</ul>
<h4 id="지속성-Durability"><a href="#지속성-Durability" class="headerlink" title="지속성(Durability)"></a>지속성(Durability)</h4><ul>
<li>트랜잭션이 성공적으로 커밋됐다면 H/W 혹은 S/W 결함이 발생하더라도 트랜잭션에서 기록한 모든 데이터는 손실되지 않는다는 보장. 보통 비휘발성 저장소에 저장되는 데이터에 대해 데이터 구조가 오염됐을 때 복구해주는 쓰기 전 로그(write-ahead log)와 비슷한 수단을 동반함.</li>
<li>지속성을 보장하려면 성공적으로 커밋됐다고 보고하기 전에 쓰기나 복제가 완료될 때까지 기다려야 한다.<blockquote>
<p>현실에서 절대적 보장을 제공하는 한 가지 기법은 없다.<br>디스크에 쓰기, 원격 장비에 복제하기, 백업 등을 포함해 위험을 줄이려는 기법이 여러 가지 있을 뿐이다.<br>이들은 함께 쓸 수 있으며 그래야만 한다. 이론적인 <code>보장</code>은 약간 에누리해서 듣는게 현명하다.</p>
</blockquote>
</li>
</ul>
<h3 id="단일-다중-객체-연산"><a href="#단일-다중-객체-연산" class="headerlink" title="단일/다중 객체 연산"></a>단일/다중 객체 연산</h3><ul>
<li><p>철수와 영식이가 이메일 서비스를 이용하고 있다고 가정해보자.</p>
<img src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNTExcHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo1ODRweDtoZWlnaHQ6NTExcHg7YmFja2dyb3VuZDojRkZGRkZGOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNTg0IDUxMSIgd2lkdGg9IjU4NHB4IiB6b29tQW5kUGFuPSJtYWduaWZ5Ij48ZGVmcz48ZmlsdGVyIGhlaWdodD0iMzAwJSIgaWQ9ImYxbHhxYXVhaWl2emVtIiB3aWR0aD0iMzAwJSIgeD0iLTEiIHk9Ii0xIj48ZmVHYXVzc2lhbkJsdXIgcmVzdWx0PSJibHVyT3V0IiBzdGREZXZpYXRpb249IjIuMCIvPjxmZUNvbG9yTWF0cml4IGluPSJibHVyT3V0IiByZXN1bHQ9ImJsdXJPdXQyIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgLjQgMCIvPjxmZU9mZnNldCBkeD0iNC4wIiBkeT0iNC4wIiBpbj0iYmx1ck91dDIiIHJlc3VsdD0iYmx1ck91dDMiLz48ZmVCbGVuZCBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJibHVyT3V0MyIgbW9kZT0ibm9ybWFsIi8+PC9maWx0ZXI+PC9kZWZzPjxnPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6NS4wLDUuMDsiIHgxPSIyMiIgeDI9IjIyIiB5MT0iODguMjk2OSIgeTI9IjQyNy4wMjM0Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7c3Ryb2tlLWRhc2hhcnJheTo1LjAsNS4wOyIgeDE9IjI5NSIgeDI9IjI5NSIgeTE9Ijg4LjI5NjkiIHkyPSI0MjcuMDIzNCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6NS4wLDUuMDsiIHgxPSI1NjIiIHgyPSI1NjIiIHkxPSI4OC4yOTY5IiB5Mj0iNDI3LjAyMzQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyOCIgeD0iNSIgeT0iODQuOTk1MSI+7LKg7IiYPC90ZXh0PjxlbGxpcHNlIGN4PSIyMiIgY3k9IjE1IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZjFseHFhdWFpaXZ6ZW0pIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjxwYXRoIGQ9Ik0yMiwyMyBMMjIsNTAgTTksMzEgTDM1LDMxIE0yMiw1MCBMOSw2NSBNMjIsNTAgTDM1LDY1ICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2YxbHhxYXVhaWl2emVtKSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjgiIHg9IjUiIHk9IjQzOS4wMTg2Ij7ssqDsiJg8L3RleHQ+PGVsbGlwc2UgY3g9IjIyIiBjeT0iNDUyLjMyMDMiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMWx4cWF1YWlpdnplbSkiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHBhdGggZD0iTTIyLDQ2MC4zMjAzIEwyMiw0ODcuMzIwMyBNOSw0NjguMzIwMyBMMzUsNDY4LjMyMDMgTTIyLDQ4Ny4zMjAzIEw5LDUwMi4zMjAzIE0yMiw0ODcuMzIwMyBMMzUsNTAyLjMyMDMgIiBmaWxsPSJub25lIiBmaWx0ZXI9InVybCgjZjFseHFhdWFpaXZ6ZW0pIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMSIgeD0iMjgxLjUiIHk9Ijg0Ljk5NTEiPkRCPC90ZXh0PjxwYXRoIGQ9Ik0yNzcsMzYgQzI3NywyNiAyOTUsMjYgMjk1LDI2IEMyOTUsMjYgMzEzLDI2IDMxMywzNiBMMzEzLDYyIEMzMTMsNzIgMjk1LDcyIDI5NSw3MiBDMjk1LDcyIDI3Nyw3MiAyNzcsNjIgTDI3NywzNiAiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMWx4cWF1YWlpdnplbSkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxwYXRoIGQ9Ik0yNzcsMzYgQzI3Nyw0NiAyOTUsNDYgMjk1LDQ2IEMyOTUsNDYgMzEzLDQ2IDMxMywzNiAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIxIiB4PSIyODEuNSIgeT0iNDM5LjAxODYiPkRCPC90ZXh0PjxwYXRoIGQ9Ik0yNzcsNDUyLjMyMDMgQzI3Nyw0NDIuMzIwMyAyOTUsNDQyLjMyMDMgMjk1LDQ0Mi4zMjAzIEMyOTUsNDQyLjMyMDMgMzEzLDQ0Mi4zMjAzIDMxMyw0NTIuMzIwMyBMMzEzLDQ3OC4zMjAzIEMzMTMsNDg4LjMyMDMgMjk1LDQ4OC4zMjAzIDI5NSw0ODguMzIwMyBDMjk1LDQ4OC4zMjAzIDI3Nyw0ODguMzIwMyAyNzcsNDc4LjMyMDMgTDI3Nyw0NTIuMzIwMyAiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMWx4cWF1YWlpdnplbSkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxwYXRoIGQ9Ik0yNzcsNDUyLjMyMDMgQzI3Nyw0NjIuMzIwMyAyOTUsNDYyLjMyMDMgMjk1LDQ2Mi4zMjAzIEMyOTUsNDYyLjMyMDMgMzEzLDQ2Mi4zMjAzIDMxMyw0NTIuMzIwMyAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI4IiB4PSI1NDUiIHk9Ijg0Ljk5NTEiPuyYgeyLnTwvdGV4dD48ZWxsaXBzZSBjeD0iNTYyIiBjeT0iMTUiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMWx4cWF1YWlpdnplbSkiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHBhdGggZD0iTTU2MiwyMyBMNTYyLDUwIE01NDksMzEgTDU3NSwzMSBNNTYyLDUwIEw1NDksNjUgTTU2Miw1MCBMNTc1LDY1ICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2YxbHhxYXVhaWl2emVtKSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjgiIHg9IjU0NSIgeT0iNDM5LjAxODYiPuyYgeyLnTwvdGV4dD48ZWxsaXBzZSBjeD0iNTYyIiBjeT0iNDUyLjMyMDMiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMWx4cWF1YWlpdnplbSkiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHBhdGggZD0iTTU2Miw0NjAuMzIwMyBMNTYyLDQ4Ny4zMjAzIE01NDksNDY4LjMyMDMgTDU3NSw0NjguMzIwMyBNNTYyLDQ4Ny4zMjAzIEw1NDksNTAyLjMyMDMgTTU2Miw0ODcuMzIwMyBMNTc1LDUwMi4zMjAzICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2YxbHhxYXVhaWl2emVtKSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIyODMsMTE1LjQyOTcsMjkzLDExOS40Mjk3LDI4MywxMjMuNDI5NywyODcsMTE5LjQyOTciIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjIyIiB4Mj0iMjg5IiB5MT0iMTE5LjQyOTciIHkyPSIxMTkuNDI5NyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI0OSIgeD0iMjkiIHk9IjExNC4zNjM4Ij5pbnNlcnQgaW50byBlbWFpbHMgdmFsdWVzKDIsICdIZWxsbycgdHJ1ZSk8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzMywxNDQuNTYyNSwyMywxNDguNTYyNSwzMywxNTIuNTYyNSwyOSwxNDguNTYyNSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMjciIHgyPSIyOTQiIHkxPSIxNDguNTYyNSIgeTI9IjE0OC41NjI1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUiIHg9IjM5IiB5PSIxNDMuNDk2NiI+b2s8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzMDYsMTg4LjgyODEsMjk2LDE5Mi44MjgxLDMwNiwxOTYuODI4MSwzMDIsMTkyLjgyODEiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjMwMCIgeDI9IjU2MSIgeTE9IjE5Mi44MjgxIiB5Mj0iMTkyLjgyODEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMzkiIHg9IjMxMiIgeT0iMTcyLjYyOTQiPnNlbGVjdCBib2R5LCB1bnJlYWRfZmxhZyBmcm9tIGVtYWlsczwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOTQiIHg9IjMxMiIgeT0iMTg3Ljc2MjIiPndoZXJlIHJlY2lwaWVudF9pZCA9IDIgbGltaXQgNTA8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI1NTAsMjMwLjUyNzMsNTYwLDIzNC41MjczLDU1MCwyMzguNTI3Myw1NTQsMjM0LjUyNzMiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjI5NSIgeDI9IjU1NiIgeTE9IjIzNC41MjczIiB5Mj0iMjM0LjUyNzMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2NSIgeD0iMzAyIiB5PSIyMjkuNDYxNCI+SGVsbG8sIHRydWU8L3RleHQ+PHBhdGggZD0iTTg4LDIwNS44MjgxIEw4OCwyNDUuODI4MSBMMjg2LDI0NS44MjgxIEwyODYsMjE1LjgyODEgTDI3NiwyMDUuODI4MSBMODgsMjA1LjgyODEgIiBmaWxsPSIjRkJGQjc3IiBmaWx0ZXI9InVybCgjZjFseHFhdWFpaXZ6ZW0pIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMjc2LDIwNS44MjgxIEwyNzYsMjE1LjgyODEgTDI4NiwyMTUuODI4MSBMMjc2LDIwNS44MjgxICIgZmlsbD0iI0ZCRkI3NyIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMyIgeD0iOTQiIHk9IjIyMi44OTUiPkRpcnR5IFJlYWQg67Cc7IOdPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE3NyIgeD0iOTQiIHk9IjIzOC4wMjc4Ij46IOy7pOuwi+uQmOyngCDslYrsnYAg642w7J207YSw66W8IOydveydjDwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjMwNiwyODcuMzU5NCwyOTYsMjkxLjM1OTQsMzA2LDI5NS4zNTk0LDMwMiwyOTEuMzU5NCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMzAwIiB4Mj0iNTYxIiB5MT0iMjkxLjM1OTQiIHkyPSIyOTEuMzU5NCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE5MiIgeD0iMzEyIiB5PSIyNzEuMTYwNiI+c2VsZWN0IHVucmVhZCBmcm9tIG1haWxib3hlczwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNDMiIHg9IjMxMiIgeT0iMjg2LjI5MzUiPndoZXJlIHJlY2lwaWVudF9pZCA9IDI8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI1NTAsMzE2LjQ5MjIsNTYwLDMyMC40OTIyLDU1MCwzMjQuNDkyMiw1NTQsMzIwLjQ5MjIiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjI5NSIgeDI9IjU1NiIgeTE9IjMyMC40OTIyIiB5Mj0iMzIwLjQ5MjIiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4IiB4PSIzMDIiIHk9IjMxNS40MjYzIj4wPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMjgzLDM3NS44OTA2LDI5MywzNzkuODkwNiwyODMsMzgzLjg5MDYsMjg3LDM3OS44OTA2IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSIyMiIgeDI9IjI4OSIgeTE9IjM3OS44OTA2IiB5Mj0iMzc5Ljg5MDYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTUiIHg9IjI5IiB5PSIzNDQuNTU5MSI+dXBkYXRlIG1haWxib3hlczwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNTgiIHg9IjI5IiB5PSIzNTkuNjkxOSI+c2V0IHVucmVhZCA9IHVucmVhZCArIDE8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQzIiB4PSIyOSIgeT0iMzc0LjgyNDciPndoZXJlIHJlY2lwaWVudF9pZCA9IDI8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzMyw0MDUuMDIzNCwyMyw0MDkuMDIzNCwzMyw0MTMuMDIzNCwyOSw0MDkuMDIzNCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMjciIHgyPSIyOTQiIHkxPSI0MDkuMDIzNCIgeTI9IjQwOS4wMjM0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUiIHg9IjM5IiB5PSI0MDMuOTU3NSI+b2s8L3RleHQ+PCEtLU1ENT1bNTdkMjg2MGU0MTE1NWU5OTk0ZDkyYTlkMzNjZTA2ZmNdCkBzdGFydHVtbA0KYWN0b3Ig7LKg7IiYDQpkYXRhYmFzZSBEQg0KYWN0b3Ig7JiB7IudDQoNCuyyoOyImCAtPiBEQjogaW5zZXJ0IGludG8gZW1haWxzIHZhbHVlcygyLCAnSGVsbG8nIHRydWUpDQpEQiAtPiDssqDsiJg6IG9rDQrsmIHsi50gLT4gREI6IHNlbGVjdCBib2R5LCB1bnJlYWRfZmxhZyBmcm9tIGVtYWlscyBcbndoZXJlIHJlY2lwaWVudF9pZCA9IDIgbGltaXQgNTANCkRCIC0+IOyYgeyLnTogSGVsbG8sIHRydWUNCm5vdGUgbGVmdDogKipEaXJ0eSBSZWFkIOuwnOyDnSoqXG46IOy7pOuwi+uQmOyngCDslYrsnYAg642w7J207YSw66W8IOydveydjA0K7JiB7IudIC0+IERCOiBzZWxlY3QgdW5yZWFkIGZyb20gbWFpbGJveGVzIFxud2hlcmUgcmVjaXBpZW50X2lkID0gMg0KREIgLT4g7JiB7IudOiAwDQrssqDsiJggLT4gREI6IHVwZGF0ZSBtYWlsYm94ZXMgXG5zZXQgdW5yZWFkID0gdW5yZWFkICsgMSBcbndoZXJlIHJlY2lwaWVudF9pZCA9IDINCkRCIC0+IOyyoOyImDogb2sNCkBlbmR1bWwNCgpQbGFudFVNTCB2ZXJzaW9uIDEuMjAyMS4xMGJldGEyKFVua25vd24gY29tcGlsZSB0aW1lKQooR1BMIHNvdXJjZSBkaXN0cmlidXRpb24pCkphdmEgUnVudGltZTogSmF2YShUTSkgU0UgUnVudGltZSBFbnZpcm9ubWVudApKVk06IEphdmEgSG90U3BvdChUTSkgNjQtQml0IFNlcnZlciBWTQpEZWZhdWx0IEVuY29kaW5nOiBVVEYtOApMYW5ndWFnZTogZW4KQ291bnRyeTogVVMKLS0+PC9nPjwvc3ZnPg=='></li>
<li><p>위와 같은 상황에서 영식이는 이상한 경험을 하게 된다. 메일 내용은 존재하지만 메일박스에서 읽지 않은 메일은 0으로 표시되기 때문이다.</p>
<blockquote>
<p>물론 이메일과 같은 도메인의 특성상 심각한 문제가 되는 지점은 아니다.</p>
</blockquote>
</li>
<li><p>다중 객체(Row, Document 등) 연산에서는 읽기 연산/쓰기 연산이 동일한 트랜잭션에 속하는지 알아낼 수단이 있어야 한다. 대표적으로 <code>BEGIN TRANSACTION ~ COMMIT</code>이 있다. 비관계형 데이터베이스에서도 다중 연산을 지원하긴 하지만 연산을 묶는 방법이 없는 경우가 많다. redis multi 오퍼레이션의 경우 부분 실패 부분 성공을 볼수도 있다. </p>
<h3 id="다중-객체-트랜잭션의-필요성"><a href="#다중-객체-트랜잭션의-필요성" class="headerlink" title="다중 객체 트랜잭션의 필요성"></a>다중 객체 트랜잭션의 필요성</h3></li>
<li><p>많은 분산 데이터스토어는 다중 객체 트랜잭션 지원을 포기했다. 다중 객체 트랜잭션은 여러 파티션에 걸쳐서 구현하기가 어렵고 매우 높은 가용성과 성능이 필요한 곳에서는 방해가 되는 시나리오도 있기 때문이다. </p>
</li>
<li><p><em><strong>원자성이 없다면 오류 처리가 훨씬 더 복잡해지고 격리성이 없으면 동시성 문제가 생길 수 있다.</strong></em></p>
<h3 id="오류와-어보트-처리"><a href="#오류와-어보트-처리" class="headerlink" title="오류와 어보트 처리"></a>오류와 어보트 처리</h3></li>
<li><p>TX의 핵심은 <em><strong>오류가 생기면 어보트되고 안전하게 재시도할 수 있다는 것이다</strong></em></p>
</li>
<li><p>어보트된 트랜잭션을 재시도하는 것은 간단하지만 완벽하진 않다.</p>
<ul>
<li>실제로 성공한 트랜잭션이지만 커밋 중 네트워크 단절이 발생할 경우 재시도하면 별도의 중복 제거 메카니즘이 없다면 트랜잭션을 두 번 실행할수도 있다. </li>
<li>부하에 의한 재시도는 문제를 해결하기보다 악화시킬 수 있다. 이럴 경우 지수적 백오프 전략을 사용하여 별도로 처리하는 방법을 쓸 수 있다.</li>
<li>위의 이메일 예제처럼 부수효과가 있는 경우 2단계 커밋이 도움이 될 수 있다.</li>
</ul>
</li>
</ul>
<h2 id="완화된-격리-수준"><a href="#완화된-격리-수준" class="headerlink" title="완화된 격리 수준"></a>완화된 격리 수준</h2><ul>
<li>동시성 문제는 TX가 다른 TX에서 동시에 변경한 데이터를 읽거나 두 TX가 동시에 같은 데이터를 변경하려고 할 떄만 나타난다.</li>
<li>문제 해결을 위해 직렬성 격리를 고려해볼 수 있지만 이는 동시성은 보장하겠지만 모든 이슈로부터 보호해주지 않는 완화된 격리 수준을 사용하는 시스템들이 흔하다.(인기있는 데이터베이스들 조차도 완화된 격리성을 사용하는 경우가 많다) 결국, 존재하는 동시성에 대한 종류를 잘 이해하고 방지하는 방법을 배우는 것이 필수다.</li>
</ul>
<h3 id="커밋-후-읽기-READ-COMMITTED"><a href="#커밋-후-읽기-READ-COMMITTED" class="headerlink" title="커밋 후 읽기(READ COMMITTED)"></a>커밋 후 읽기(READ COMMITTED)</h3><ul>
<li>가장 기본적인 수준의 트랜잭션 격리</li>
<li>데이터베이스에서 읽을 때 커밋된 데이터만 보게된다.(Dirty Read가 없다)</li>
<li>데이터베이스에서 쓸 때 커밋된 데이터만 덮어쓰게 된다.(Dirty Write가 없다)</li>
</ul>
<h4 id="더티-읽기-방지"><a href="#더티-읽기-방지" class="headerlink" title="더티 읽기 방지"></a>더티 읽기 방지</h4><img src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNTUycHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo0NzJweDtoZWlnaHQ6NTUycHg7YmFja2dyb3VuZDojRkZGRkZGOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNDcyIDU1MiIgd2lkdGg9IjQ3MnB4IiB6b29tQW5kUGFuPSJtYWduaWZ5Ij48ZGVmcz48ZmlsdGVyIGhlaWdodD0iMzAwJSIgaWQ9ImZxamZxaXZzeDlqN2ciIHdpZHRoPSIzMDAlIiB4PSItMSIgeT0iLTEiPjxmZUdhdXNzaWFuQmx1ciByZXN1bHQ9ImJsdXJPdXQiIHN0ZERldmlhdGlvbj0iMi4wIi8+PGZlQ29sb3JNYXRyaXggaW49ImJsdXJPdXQiIHJlc3VsdD0iYmx1ck91dDIiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAuNCAwIi8+PGZlT2Zmc2V0IGR4PSI0LjAiIGR5PSI0LjAiIGluPSJibHVyT3V0MiIgcmVzdWx0PSJibHVyT3V0MyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImJsdXJPdXQzIiBtb2RlPSJub3JtYWwiLz48L2ZpbHRlcj48L2RlZnM+PGc+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgZmlsdGVyPSJ1cmwoI2ZxamZxaXZzeDlqN2cpIiBoZWlnaHQ9IjIwMy45Mjk3IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHdpZHRoPSIxMCIgeD0iMjguNSIgeT0iMTc3LjY5NTMiLz48cmVjdCBmaWxsPSIjRkZGRkZGIiBmaWx0ZXI9InVybCgjZnFqZnFpdnN4OWo3ZykiIGhlaWdodD0iMzM5LjQ2MDkiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgd2lkdGg9IjEwIiB4PSIyMjUuNSIgeT0iMTE5LjQyOTciLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjUuMCw1LjA7IiB4MT0iMzMiIHgyPSIzMyIgeTE9Ijg4LjI5NjkiIHkyPSI0NjcuODkwNiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6NS4wLDUuMDsiIHgxPSIxNjguNSIgeDI9IjE2OC41IiB5MT0iODguMjk2OSIgeTI9IjQ2Ny44OTA2Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7c3Ryb2tlLWRhc2hhcnJheTo1LjAsNS4wOyIgeDE9IjIzMC41IiB4Mj0iMjMwLjUiIHkxPSI4OC4yOTY5IiB5Mj0iNDY3Ljg5MDYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1MSIgeD0iNSIgeT0iODQuOTk1MSI+7IKs7Jqp7J6QMTwvdGV4dD48ZWxsaXBzZSBjeD0iMzMuNSIgY3k9IjE1IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnFqZnFpdnN4OWo3ZykiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHBhdGggZD0iTTMzLjUsMjMgTDMzLjUsNTAgTTIwLjUsMzEgTDQ2LjUsMzEgTTMzLjUsNTAgTDIwLjUsNjUgTTMzLjUsNTAgTDQ2LjUsNjUgIiBmaWxsPSJub25lIiBmaWx0ZXI9InVybCgjZnFqZnFpdnN4OWo3ZykiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUxIiB4PSI1IiB5PSI0NzkuODg1NyI+7IKs7Jqp7J6QMTwvdGV4dD48ZWxsaXBzZSBjeD0iMzMuNSIgY3k9IjQ5My4xODc1IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZnFqZnFpdnN4OWo3ZykiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHBhdGggZD0iTTMzLjUsNTAxLjE4NzUgTDMzLjUsNTI4LjE4NzUgTTIwLjUsNTA5LjE4NzUgTDQ2LjUsNTA5LjE4NzUgTTMzLjUsNTI4LjE4NzUgTDIwLjUsNTQzLjE4NzUgTTMzLjUsNTI4LjE4NzUgTDQ2LjUsNTQzLjE4NzUgIiBmaWxsPSJub25lIiBmaWx0ZXI9InVybCgjZnFqZnFpdnN4OWo3ZykiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIxIiB4PSIxNTUiIHk9Ijg0Ljk5NTEiPkRCPC90ZXh0PjxwYXRoIGQ9Ik0xNTAuNSwzNiBDMTUwLjUsMjYgMTY4LjUsMjYgMTY4LjUsMjYgQzE2OC41LDI2IDE4Ni41LDI2IDE4Ni41LDM2IEwxODYuNSw2MiBDMTg2LjUsNzIgMTY4LjUsNzIgMTY4LjUsNzIgQzE2OC41LDcyIDE1MC41LDcyIDE1MC41LDYyIEwxNTAuNSwzNiAiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmcWpmcWl2c3g5ajdnKSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PHBhdGggZD0iTTE1MC41LDM2IEMxNTAuNSw0NiAxNjguNSw0NiAxNjguNSw0NiBDMTY4LjUsNDYgMTg2LjUsNDYgMTg2LjUsMzYgIiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMSIgeD0iMTU1IiB5PSI0NzkuODg1NyI+REI8L3RleHQ+PHBhdGggZD0iTTE1MC41LDQ5My4xODc1IEMxNTAuNSw0ODMuMTg3NSAxNjguNSw0ODMuMTg3NSAxNjguNSw0ODMuMTg3NSBDMTY4LjUsNDgzLjE4NzUgMTg2LjUsNDgzLjE4NzUgMTg2LjUsNDkzLjE4NzUgTDE4Ni41LDUxOS4xODc1IEMxODYuNSw1MjkuMTg3NSAxNjguNSw1MjkuMTg3NSAxNjguNSw1MjkuMTg3NSBDMTY4LjUsNTI5LjE4NzUgMTUwLjUsNTI5LjE4NzUgMTUwLjUsNTE5LjE4NzUgTDE1MC41LDQ5My4xODc1ICIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2ZxamZxaXZzeDlqN2cpIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48cGF0aCBkPSJNMTUwLjUsNDkzLjE4NzUgQzE1MC41LDUwMy4xODc1IDE2OC41LDUwMy4xODc1IDE2OC41LDUwMy4xODc1IEMxNjguNSw1MDMuMTg3NSAxODYuNSw1MDMuMTg3NSAxODYuNSw0OTMuMTg3NSAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwIiB4PSIyMDIuNSIgeT0iODQuOTk1MSI+7IKs7Jqp7J6QMjwvdGV4dD48ZWxsaXBzZSBjeD0iMjMwLjUiIGN5PSIxNSIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2ZxamZxaXZzeDlqN2cpIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjxwYXRoIGQ9Ik0yMzAuNSwyMyBMMjMwLjUsNTAgTTIxNy41LDMxIEwyNDMuNSwzMSBNMjMwLjUsNTAgTDIxNy41LDY1IE0yMzAuNSw1MCBMMjQzLjUsNjUgIiBmaWxsPSJub25lIiBmaWx0ZXI9InVybCgjZnFqZnFpdnN4OWo3ZykiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUwIiB4PSIyMDIuNSIgeT0iNDc5Ljg4NTciPuyCrOyaqeyekDI8L3RleHQ+PGVsbGlwc2UgY3g9IjIzMC41IiBjeT0iNDkzLjE4NzUiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmcWpmcWl2c3g5ajdnKSIgcng9IjgiIHJ5PSI4IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48cGF0aCBkPSJNMjMwLjUsNTAxLjE4NzUgTDIzMC41LDUyOC4xODc1IE0yMTcuNSw1MDkuMTg3NSBMMjQzLjUsNTA5LjE4NzUgTTIzMC41LDUyOC4xODc1IEwyMTcuNSw1NDMuMTg3NSBNMjMwLjUsNTI4LjE4NzUgTDI0My41LDU0My4xODc1ICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2ZxamZxaXZzeDlqN2cpIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48cmVjdCBmaWxsPSIjRkZGRkZGIiBmaWx0ZXI9InVybCgjZnFqZnFpdnN4OWo3ZykiIGhlaWdodD0iMjAzLjkyOTciIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgd2lkdGg9IjEwIiB4PSIyOC41IiB5PSIxNzcuNjk1MyIvPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGZpbHRlcj0idXJsKCNmcWpmcWl2c3g5ajdnKSIgaGVpZ2h0PSIzMzkuNDYwOSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB3aWR0aD0iMTAiIHg9IjIyNS41IiB5PSIxMTkuNDI5NyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMTc5LjUsMTE1LjQyOTcsMTY5LjUsMTE5LjQyOTcsMTc5LjUsMTIzLjQyOTcsMTc1LjUsMTE5LjQyOTciIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjE3My41IiB4Mj0iMjI0LjUiIHkxPSIxMTkuNDI5NyIgeTI9IjExOS40Mjk3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzMiIHg9IjE4NS41IiB5PSIxMTQuMzYzOCI+Z2V0IHg8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIyMTMuNSwxNDQuNTYyNSwyMjMuNSwxNDguNTYyNSwyMTMuNSwxNTIuNTYyNSwyMTcuNSwxNDguNTYyNSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMTY4LjUiIHgyPSIyMTkuNSIgeTE9IjE0OC41NjI1IiB5Mj0iMTQ4LjU2MjUiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4IiB4PSIxNzUuNSIgeT0iMTQzLjQ5NjYiPjI8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIxNTYuNSwxNzMuNjk1MywxNjYuNSwxNzcuNjk1MywxNTYuNSwxODEuNjk1MywxNjAuNSwxNzcuNjk1MyIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMzguNSIgeDI9IjE2Mi41IiB5MT0iMTc3LjY5NTMiIHkyPSIxNzcuNjk1MyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMSIgeD0iNDUuNSIgeT0iMTcyLjYyOTQiPmJlZ2luIHRyYW5zYWN0aW9uPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMTU2LjUsMjAyLjgyODEsMTY2LjUsMjA2LjgyODEsMTU2LjUsMjEwLjgyODEsMTYwLjUsMjA2LjgyODEiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjM4LjUiIHgyPSIxNjIuNSIgeTE9IjIwNi44MjgxIiB5Mj0iMjA2LjgyODEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1OCIgeD0iNDUuNSIgeT0iMjAxLjc2MjIiPnNldCB4ID0gMzwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjQ5LjUsMjMxLjk2MDksMzkuNSwyMzUuOTYwOSw0OS41LDIzOS45NjA5LDQ1LjUsMjM1Ljk2MDkiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjQzLjUiIHgyPSIxNjcuNSIgeTE9IjIzNS45NjA5IiB5Mj0iMjM1Ljk2MDkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOCIgeD0iNTUuNSIgeT0iMjMwLjg5NSI+T0s8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIxNzkuNSwyNjEuMDkzOCwxNjkuNSwyNjUuMDkzOCwxNzkuNSwyNjkuMDkzOCwxNzUuNSwyNjUuMDkzOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMTczLjUiIHgyPSIyMjQuNSIgeTE9IjI2NS4wOTM4IiB5Mj0iMjY1LjA5MzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMyIgeD0iMTg1LjUiIHk9IjI2MC4wMjc4Ij5nZXQgeDwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjIxMy41LDI5MC4yMjY2LDIyMy41LDI5NC4yMjY2LDIxMy41LDI5OC4yMjY2LDIxNy41LDI5NC4yMjY2IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSIxNjguNSIgeDI9IjIxOS41IiB5MT0iMjk0LjIyNjYiIHkyPSIyOTQuMjI2NiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgiIHg9IjE3NS41IiB5PSIyODkuMTYwNiI+MjwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjE1Ni41LDMxOS4zNTk0LDE2Ni41LDMyMy4zNTk0LDE1Ni41LDMyNy4zNTk0LDE2MC41LDMyMy4zNTk0IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSIzOC41IiB4Mj0iMTYyLjUiIHkxPSIzMjMuMzU5NCIgeTI9IjMyMy4zNTk0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTgiIHg9IjQ1LjUiIHk9IjMxOC4yOTM1Ij5zZXQgeSA9IDM8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0OS41LDM0OC40OTIyLDM5LjUsMzUyLjQ5MjIsNDkuNSwzNTYuNDkyMiw0NS41LDM1Mi40OTIyIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSI0My41IiB4Mj0iMTY3LjUiIHkxPSIzNTIuNDkyMiIgeTI9IjM1Mi40OTIyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTgiIHg9IjU1LjUiIHk9IjM0Ny40MjYzIj5PSzwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjE1Ni41LDM3Ny42MjUsMTY2LjUsMzgxLjYyNSwxNTYuNSwzODUuNjI1LDE2MC41LDM4MS42MjUiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjMzLjUiIHgyPSIxNjIuNSIgeTE9IjM4MS42MjUiIHkyPSIzODEuNjI1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDkiIHg9IjQwLjUiIHk9IjM3Ni41NTkxIj5jb21taXQ8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIxNzkuNSw0MDYuNzU3OCwxNjkuNSw0MTAuNzU3OCwxNzkuNSw0MTQuNzU3OCwxNzUuNSw0MTAuNzU3OCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMTczLjUiIHgyPSIyMjQuNSIgeTE9IjQxMC43NTc4IiB5Mj0iNDEwLjc1NzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMyIgeD0iMTg1LjUiIHk9IjQwNS42OTE5Ij5nZXQgeDwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjIxMy41LDQ0MC44OTA2LDIyMy41LDQ0NC44OTA2LDIxMy41LDQ0OC44OTA2LDIxNy41LDQ0NC44OTA2IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSIxNjguNSIgeDI9IjIxOS41IiB5MT0iNDQ0Ljg5MDYiIHkyPSI0NDQuODkwNiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgiIHg9IjE3NS41IiB5PSI0MzkuODI0NyI+MzwvdGV4dD48cGF0aCBkPSJNMjQwLDQyMy43NTc4IEwyNDAsNDQ4Ljc1NzggTDQ2Myw0NDguNzU3OCBMNDYzLDQzMy43NTc4IEw0NTMsNDIzLjc1NzggTDI0MCw0MjMuNzU3OCAiIGZpbGw9IiNGQkZCNzciIGZpbHRlcj0idXJsKCNmcWpmcWl2c3g5ajdnKSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTQ1Myw0MjMuNzU3OCBMNDUzLDQzMy43NTc4IEw0NjMsNDMzLjc1NzggTDQ1Myw0MjMuNzU3OCAiIGZpbGw9IiNGQkZCNzciIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIwMiIgeD0iMjQ2IiB5PSI0NDAuODI0NyI+7IKs7Jqp7J6QMeydtCDsu6TrsIvtlZwg6rCS7J24IGAzYOydhCDsnb3snYw8L3RleHQ+PCEtLU1ENT1bN2Q2YjkwZDNmNzU4NDZiMDY1NDJkNDE5Y2M1ODViZTFdCkBzdGFydHVtbA0KYWN0b3Ig7IKs7Jqp7J6QMQ0KZGF0YWJhc2UgREINCmFjdG9yIOyCrOyaqeyekDINCg0KDQrsgqzsmqnsnpAyIC0+IERCOiBnZXQgeA0KYWN0aXZhdGUg7IKs7Jqp7J6QMg0KREIgLT4g7IKs7Jqp7J6QMjogMg0KDQoNCuyCrOyaqeyekDEgLT4gREI6IGJlZ2luIHRyYW5zYWN0aW9uDQphY3RpdmF0ZSDsgqzsmqnsnpAxDQrsgqzsmqnsnpAxIC0+IERCOiBzZXQgeCA9IDMNCkRCIC0+IOyCrOyaqeyekDE6IE9LDQoNCuyCrOyaqeyekDIgLT4gREI6IGdldCB4DQpEQiAtPiDsgqzsmqnsnpAyOiAyDQoNCuyCrOyaqeyekDEgLT4gREI6IHNldCB5ID0gMw0KREIgLT4g7IKs7Jqp7J6QMTogT0sNCuyCrOyaqeyekDEgLT4gREI6IGNvbW1pdA0KZGVhY3RpdmF0ZSDsgqzsmqnsnpAxDQoNCuyCrOyaqeyekDIgLT4gREI6IGdldCB4DQpEQiAtPiDsgqzsmqnsnpAyOiAzDQpub3RlIHJpZ2h0OiDsgqzsmqnsnpAx7J20IOy7pOuwi+2VnCDqsJLsnbggYDNg7J2EIOydveydjA0KQGVuZHVtbA0KClBsYW50VU1MIHZlcnNpb24gMS4yMDIxLjEwYmV0YTIoVW5rbm93biBjb21waWxlIHRpbWUpCihHUEwgc291cmNlIGRpc3RyaWJ1dGlvbikKSmF2YSBSdW50aW1lOiBKYXZhKFRNKSBTRSBSdW50aW1lIEVudmlyb25tZW50CkpWTTogSmF2YSBIb3RTcG90KFRNKSA2NC1CaXQgU2VydmVyIFZNCkRlZmF1bHQgRW5jb2Rpbmc6IFVURi04Ckxhbmd1YWdlOiBlbgpDb3VudHJ5OiBVUwotLT48L2c+PC9zdmc+'>

<ul>
<li><em><strong>TX가 여러 객체를 갱신하는데 더티 읽기가 생기면 다른 TX에서 일부는 갱신된 값을, 일부는 갱신되지 않은 값을 볼 수 있다.</strong></em></li>
</ul>
<h4 id="더티-쓰기-방지"><a href="#더티-쓰기-방지" class="headerlink" title="더티 쓰기 방지"></a>더티 쓰기 방지</h4><ul>
<li>먼저 쓴 내용이 아직 커밋되지 않은 트랜잭션에서 쓴 것이고, 나중에 실행된 쓰기 작업이 커밋되지 않은 값을 겊어써버리는 걸 <code>더티 쓰기(Dirty Write)</code>라고 한다.</li>
<li>두 TX에서 데이터베이스의 동일 객체를 갱신하려고 할때 일반적으로 나중에 쓴 내용이 먼저 쓴 내용을 덮어쓴다고 가정한다. <code>READ_COMMITTED</code> 격리 수준에서는 이러한 더티 쓰기를 방지해야 하며, 먼저 쓴 TX가 커밋/어보트될 때까지 두 번째 쓰기를 지연시키는 방법을 쓴다.</li>
</ul>
<img src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNDI1cHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo5MjhweDtoZWlnaHQ6NDI1cHg7YmFja2dyb3VuZDojRkZGRkZGOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgOTI4IDQyNSIgd2lkdGg9IjkyOHB4IiB6b29tQW5kUGFuPSJtYWduaWZ5Ij48ZGVmcz48ZmlsdGVyIGhlaWdodD0iMzAwJSIgaWQ9ImYxMXViOGw3ZzNyMnowIiB3aWR0aD0iMzAwJSIgeD0iLTEiIHk9Ii0xIj48ZmVHYXVzc2lhbkJsdXIgcmVzdWx0PSJibHVyT3V0IiBzdGREZXZpYXRpb249IjIuMCIvPjxmZUNvbG9yTWF0cml4IGluPSJibHVyT3V0IiByZXN1bHQ9ImJsdXJPdXQyIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgLjQgMCIvPjxmZU9mZnNldCBkeD0iNC4wIiBkeT0iNC4wIiBpbj0iYmx1ck91dDIiIHJlc3VsdD0iYmx1ck91dDMiLz48ZmVCbGVuZCBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJibHVyT3V0MyIgbW9kZT0ibm9ybWFsIi8+PC9maWx0ZXI+PC9kZWZzPjxnPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6NS4wLDUuMDsiIHgxPSIyMiIgeDI9IjIyIiB5MT0iODguMjk2OSIgeTI9IjM0MS4zNTk0Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7c3Ryb2tlLWRhc2hhcnJheTo1LjAsNS4wOyIgeDE9IjQzMyIgeDI9IjQzMyIgeTE9Ijg4LjI5NjkiIHkyPSIzNDEuMzU5NCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6NS4wLDUuMDsiIHgxPSI0NzkiIHgyPSI0NzkiIHkxPSI4OC4yOTY5IiB5Mj0iMzQxLjM1OTQiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjUuMCw1LjA7IiB4MT0iOTAzIiB4Mj0iOTAzIiB5MT0iODguMjk2OSIgeTI9IjM0MS4zNTk0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjgiIHg9IjUiIHk9Ijg0Ljk5NTEiPuyyoOyImDwvdGV4dD48ZWxsaXBzZSBjeD0iMjIiIGN5PSIxNSIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxMXViOGw3ZzNyMnowKSIgcng9IjgiIHJ5PSI4IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48cGF0aCBkPSJNMjIsMjMgTDIyLDUwIE05LDMxIEwzNSwzMSBNMjIsNTAgTDksNjUgTTIyLDUwIEwzNSw2NSAiIGZpbGw9Im5vbmUiIGZpbHRlcj0idXJsKCNmMTF1YjhsN2czcjJ6MCkiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI4IiB4PSI1IiB5PSIzNTMuMzU0NSI+7LKg7IiYPC90ZXh0PjxlbGxpcHNlIGN4PSIyMiIgY3k9IjM2Ni42NTYzIiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZjExdWI4bDdnM3IyejApIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjxwYXRoIGQ9Ik0yMiwzNzQuNjU2MyBMMjIsNDAxLjY1NjMgTTksMzgyLjY1NjMgTDM1LDM4Mi42NTYzIE0yMiw0MDEuNjU2MyBMOSw0MTYuNjU2MyBNMjIsNDAxLjY1NjMgTDM1LDQxNi42NTYzICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2YxMXViOGw3ZzNyMnowKSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjgiIHg9IjQxNiIgeT0iODQuOTk1MSI+66qp66GdPC90ZXh0PjxwYXRoIGQ9Ik00MTUsMzYgQzQxNSwyNiA0MzMsMjYgNDMzLDI2IEM0MzMsMjYgNDUxLDI2IDQ1MSwzNiBMNDUxLDYyIEM0NTEsNzIgNDMzLDcyIDQzMyw3MiBDNDMzLDcyIDQxNSw3MiA0MTUsNjIgTDQxNSwzNiAiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMTF1YjhsN2czcjJ6MCkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxwYXRoIGQ9Ik00MTUsMzYgQzQxNSw0NiA0MzMsNDYgNDMzLDQ2IEM0MzMsNDYgNDUxLDQ2IDQ1MSwzNiAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI4IiB4PSI0MTYiIHk9IjM1My4zNTQ1Ij7rqqnroZ08L3RleHQ+PHBhdGggZD0iTTQxNSwzNjYuNjU2MyBDNDE1LDM1Ni42NTYzIDQzMywzNTYuNjU2MyA0MzMsMzU2LjY1NjMgQzQzMywzNTYuNjU2MyA0NTEsMzU2LjY1NjMgNDUxLDM2Ni42NTYzIEw0NTEsMzkyLjY1NjMgQzQ1MSw0MDIuNjU2MyA0MzMsNDAyLjY1NjMgNDMzLDQwMi42NTYzIEM0MzMsNDAyLjY1NjMgNDE1LDQwMi42NTYzIDQxNSwzOTIuNjU2MyBMNDE1LDM2Ni42NTYzICIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxMXViOGw3ZzNyMnowKSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PHBhdGggZD0iTTQxNSwzNjYuNjU2MyBDNDE1LDM3Ni42NTYzIDQzMywzNzYuNjU2MyA0MzMsMzc2LjY1NjMgQzQzMywzNzYuNjU2MyA0NTEsMzc2LjY1NjMgNDUxLDM2Ni42NTYzICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjgiIHg9IjQ2MiIgeT0iODQuOTk1MSI+7Iah7J6lPC90ZXh0PjxwYXRoIGQ9Ik00NjEsMzYgQzQ2MSwyNiA0NzksMjYgNDc5LDI2IEM0NzksMjYgNDk3LDI2IDQ5NywzNiBMNDk3LDYyIEM0OTcsNzIgNDc5LDcyIDQ3OSw3MiBDNDc5LDcyIDQ2MSw3MiA0NjEsNjIgTDQ2MSwzNiAiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMTF1YjhsN2czcjJ6MCkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxwYXRoIGQ9Ik00NjEsMzYgQzQ2MSw0NiA0NzksNDYgNDc5LDQ2IEM0NzksNDYgNDk3LDQ2IDQ5NywzNiAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI4IiB4PSI0NjIiIHk9IjM1My4zNTQ1Ij7shqHsnqU8L3RleHQ+PHBhdGggZD0iTTQ2MSwzNjYuNjU2MyBDNDYxLDM1Ni42NTYzIDQ3OSwzNTYuNjU2MyA0NzksMzU2LjY1NjMgQzQ3OSwzNTYuNjU2MyA0OTcsMzU2LjY1NjMgNDk3LDM2Ni42NTYzIEw0OTcsMzkyLjY1NjMgQzQ5Nyw0MDIuNjU2MyA0NzksNDAyLjY1NjMgNDc5LDQwMi42NTYzIEM0NzksNDAyLjY1NjMgNDYxLDQwMi42NTYzIDQ2MSwzOTIuNjU2MyBMNDYxLDM2Ni42NTYzICIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxMXViOGw3ZzNyMnowKSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PHBhdGggZD0iTTQ2MSwzNjYuNjU2MyBDNDYxLDM3Ni42NTYzIDQ3OSwzNzYuNjU2MyA0NzksMzc2LjY1NjMgQzQ3OSwzNzYuNjU2MyA0OTcsMzc2LjY1NjMgNDk3LDM2Ni42NTYzICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDIiIHg9Ijg3OSIgeT0iODQuOTk1MSI+7JiB7Iud7J20PC90ZXh0PjxlbGxpcHNlIGN4PSI5MDMiIGN5PSIxNSIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxMXViOGw3ZzNyMnowKSIgcng9IjgiIHJ5PSI4IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48cGF0aCBkPSJNOTAzLDIzIEw5MDMsNTAgTTg5MCwzMSBMOTE2LDMxIE05MDMsNTAgTDg5MCw2NSBNOTAzLDUwIEw5MTYsNjUgIiBmaWxsPSJub25lIiBmaWx0ZXI9InVybCgjZjExdWI4bDdnM3IyejApIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MiIgeD0iODc5IiB5PSIzNTMuMzU0NSI+7JiB7Iud7J20PC90ZXh0PjxlbGxpcHNlIGN4PSI5MDMiIGN5PSIzNjYuNjU2MyIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxMXViOGw3ZzNyMnowKSIgcng9IjgiIHJ5PSI4IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48cGF0aCBkPSJNOTAzLDM3NC42NTYzIEw5MDMsNDAxLjY1NjMgTTg5MCwzODIuNjU2MyBMOTE2LDM4Mi42NTYzIE05MDMsNDAxLjY1NjMgTDg5MCw0MTYuNjU2MyBNOTAzLDQwMS42NTYzIEw5MTYsNDE2LjY1NjMgIiBmaWxsPSJub25lIiBmaWx0ZXI9InVybCgjZjExdWI4bDdnM3IyejApIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjQyMSwxMTUuNDI5Nyw0MzEsMTE5LjQyOTcsNDIxLDEyMy40Mjk3LDQyNSwxMTkuNDI5NyIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMjIiIHgyPSI0MjciIHkxPSIxMTkuNDI5NyIgeTI9IjExOS40Mjk3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzE3IiB4PSIyOSIgeT0iMTE0LjM2MzgiPnVwZGF0ZSBsaXN0aW5ncyBzZXQgYnV5ZXIgPSAn7LKg7IiYJyB3aGVyZSBpZCA9IDEyMzQ8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzMywxNDQuNTYyNSwyMywxNDguNTYyNSwzMywxNTIuNTYyNSwyOSwxNDguNTYyNSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMjciIHgyPSI0MzIiIHkxPSIxNDguNTYyNSIgeTI9IjE0OC41NjI1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTgiIHg9IjM5IiB5PSIxNDMuNDk2NiI+T0s8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0NDQsMTczLjY5NTMsNDM0LDE3Ny42OTUzLDQ0NCwxODEuNjk1Myw0NDAsMTc3LjY5NTMiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjQzOCIgeDI9IjkwMiIgeTE9IjE3Ny42OTUzIiB5Mj0iMTc3LjY5NTMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMzAiIHg9IjQ1MCIgeT0iMTcyLjYyOTQiPnVwZGF0ZSBsaXN0aW5ncyBzZXQgYnV5ZXIgPSAn7JiB7Iud7J20JyB3aGVyZSBpZCA9IDEyMzQ8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI4OTEsMjAyLjgyODEsOTAxLDIwNi44MjgxLDg5MSwyMTAuODI4MSw4OTUsMjA2LjgyODEiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjQzMyIgeDI9Ijg5NyIgeTE9IjIwNi44MjgxIiB5Mj0iMjA2LjgyODEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOCIgeD0iNDQwIiB5PSIyMDEuNzYyMiI+T0s8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0OTAsMjMxLjk2MDksNDgwLDIzNS45NjA5LDQ5MCwyMzkuOTYwOSw0ODYsMjM1Ljk2MDkiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjQ4NCIgeDI9IjkwMiIgeTE9IjIzNS45NjA5IiB5Mj0iMjM1Ljk2MDkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MDAiIHg9IjQ5NiIgeT0iMjMwLjg5NSI+dXBkYXRlIGludm9pY2VzIHNldCByZWNpcGllbnQgPSAn7JiB7Iud7J20JyB3aGVyZSBsaXN0aW5nX2lkID0gMTIzNDwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9Ijg5MSwyNjEuMDkzOCw5MDEsMjY1LjA5MzgsODkxLDI2OS4wOTM4LDg5NSwyNjUuMDkzOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iNDc5IiB4Mj0iODk3IiB5MT0iMjY1LjA5MzgiIHkyPSIyNjUuMDkzOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4IiB4PSI0ODYiIHk9IjI2MC4wMjc4Ij5PSzwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjQyMSwyOTAuMjI2Niw0MzEsMjk0LjIyNjYsNDIxLDI5OC4yMjY2LDQyNSwyOTQuMjI2NiIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMjIiIHgyPSI0MjciIHkxPSIyOTQuMjI2NiIgeTI9IjI5NC4yMjY2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzg3IiB4PSIyOSIgeT0iMjg5LjE2MDYiPnVwZGF0ZSBpbnZvaWNlcyBzZXQgcmVjaXBpZW50ID0gJ+yyoOyImCcgd2hlcmUgbGlzdGluZ19pZCA9IDEyMzQ8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzMywzMTkuMzU5NCwyMywzMjMuMzU5NCwzMywzMjcuMzU5NCwyOSwzMjMuMzU5NCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMjciIHgyPSI0MzIiIHkxPSIzMjMuMzU5NCIgeTI9IjMyMy4zNTk0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTgiIHg9IjM5IiB5PSIzMTguMjkzNSI+T0s8L3RleHQ+PCEtLU1ENT1bMTVhMzk3NjdiZjM1MmUxYjNkYWFjNGYwODhkNDIwYjRdCkBzdGFydHVtbA0KYWN0b3Ig7LKg7IiYDQpkYXRhYmFzZSDrqqnroZ0NCmRhdGFiYXNlIOyGoeyepQ0KYWN0b3Ig7JiB7Iud7J20DQoNCuyyoOyImCAtPiDrqqnroZ06IHVwZGF0ZSBsaXN0aW5ncyBzZXQgYnV5ZXIgPSAn7LKg7IiYJyB3aGVyZSBpZCA9IDEyMzQNCuuqqeuhnSAtPiDssqDsiJg6IE9LDQoNCuyYgeyLneydtCAtPiDrqqnroZ06IHVwZGF0ZSBsaXN0aW5ncyBzZXQgYnV5ZXIgPSAn7JiB7Iud7J20JyB3aGVyZSBpZCA9IDEyMzQNCuuqqeuhnSAtPiDsmIHsi53snbQ6IE9LDQoNCuyYgeyLneydtCAtPiDshqHsnqU6IHVwZGF0ZSBpbnZvaWNlcyBzZXQgcmVjaXBpZW50ID0gJ+yYgeyLneydtCcgd2hlcmUgbGlzdGluZ19pZCA9IDEyMzQNCuyGoeyepSAtPiDsmIHsi53snbQ6IE9LDQoNCuyyoOyImCAtPiDrqqnroZ06IHVwZGF0ZSBpbnZvaWNlcyBzZXQgcmVjaXBpZW50ID0gJ+yyoOyImCcgd2hlcmUgbGlzdGluZ19pZCA9IDEyMzQNCuuqqeuhnSAtPiDssqDsiJg6IE9LDQpAZW5kdW1sDQoKUGxhbnRVTUwgdmVyc2lvbiAxLjIwMjEuMTBiZXRhMihVbmtub3duIGNvbXBpbGUgdGltZSkKKEdQTCBzb3VyY2UgZGlzdHJpYnV0aW9uKQpKYXZhIFJ1bnRpbWU6IEphdmEoVE0pIFNFIFJ1bnRpbWUgRW52aXJvbm1lbnQKSlZNOiBKYXZhIEhvdFNwb3QoVE0pIDY0LUJpdCBTZXJ2ZXIgVk0KRGVmYXVsdCBFbmNvZGluZzogVVRGLTgKTGFuZ3VhZ2U6IGVuCkNvdW50cnk6IFVTCi0tPjwvZz48L3N2Zz4='>
<blockquote>
<p>위 예제에서는 <strong>더티 쓰기</strong>가 발생하였고,<br><em><strong>영식이와 철수 모두 같은 제품을 구매하는 상황에서 구매자는 영식이가 되고 송장은 철수로 찍혀 있는 상황이다.</strong></em></p>
</blockquote>
<h4 id="커밋-후-읽기-READ-COMMITTED-구현"><a href="#커밋-후-읽기-READ-COMMITTED-구현" class="headerlink" title="커밋 후 읽기(READ_COMMITTED) 구현"></a>커밋 후 읽기(READ_COMMITTED) 구현</h4><ul>
<li>커밋 후 읽기(READ_COMMITTED)는 Oracle, PostgreSQL, MS_SQL 등에서 기본 설정</li>
<li><em><strong>로우 수준의 잠금을 사용해 더티 쓰기를 방지하며 트랜잭션에서 특정 객체(로우/문서)를 변경하고 싶다면 먼저 해당 객체에 대한 잠금을 획득해야 한다. 그리고 트랜잭션이 커밋되거나 어보트될 때까지 잠금을 보유하고 있어야 한다. 오직 한 트랜잭션만 어떤 주어진 객체에 대한 잠금을 보유할 수 있고 다른 트랜잭션에서 동일한 객체에 쓰기를 원한다면 첫 번째 트랜잭션이 커밋/어보트된 후에야 잠금을 얻어 진행할 수 있다.</strong></em></li>
<li>더티 읽기를 막기 위해 동일한 잠금을 사용할 수 있다. 하지만, 현실적으로 잘사용하지 않고 응답 시간에 해를 끼치며 운영성이 나쁘다. 이러한 이유로 커밋 후 읽기(READ_COMMITTED)에서는 트랜잭션이 시작하면 과거에 커밋된 값과 새로운 값 모두 기억한다.</li>
<li>하지만, 커밋 후 읽기(READ_COMMITTED)에서도 동시성 버그가 생길 수 있는 경우가 많이 있다. 아래 계좌 잔고 예제를 살펴보자.</li>
</ul>
<img src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iNDI1cHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo3ODdweDtoZWlnaHQ6NDI1cHg7YmFja2dyb3VuZDojRkZGRkZGOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNzg3IDQyNSIgd2lkdGg9Ijc4N3B4IiB6b29tQW5kUGFuPSJtYWduaWZ5Ij48ZGVmcz48ZmlsdGVyIGhlaWdodD0iMzAwJSIgaWQ9ImYxNXh1a3FxZWk4djg4IiB3aWR0aD0iMzAwJSIgeD0iLTEiIHk9Ii0xIj48ZmVHYXVzc2lhbkJsdXIgcmVzdWx0PSJibHVyT3V0IiBzdGREZXZpYXRpb249IjIuMCIvPjxmZUNvbG9yTWF0cml4IGluPSJibHVyT3V0IiByZXN1bHQ9ImJsdXJPdXQyIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgLjQgMCIvPjxmZU9mZnNldCBkeD0iNC4wIiBkeT0iNC4wIiBpbj0iYmx1ck91dDIiIHJlc3VsdD0iYmx1ck91dDMiLz48ZmVCbGVuZCBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJibHVyT3V0MyIgbW9kZT0ibm9ybWFsIi8+PC9maWx0ZXI+PC9kZWZzPjxnPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6NS4wLDUuMDsiIHgxPSIyMiIgeDI9IjIyIiB5MT0iODguMjk2OSIgeTI9IjM0MS4zNTk0Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7c3Ryb2tlLWRhc2hhcnJheTo1LjAsNS4wOyIgeDE9IjMxMC41IiB4Mj0iMzEwLjUiIHkxPSI4OC4yOTY5IiB5Mj0iMzQxLjM1OTQiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjUuMCw1LjA7IiB4MT0iMzYzLjUiIHgyPSIzNjMuNSIgeTE9Ijg4LjI5NjkiIHkyPSIzNDEuMzU5NCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6NS4wLDUuMDsiIHgxPSI3NjIuNSIgeDI9Ijc2Mi41IiB5MT0iODguMjk2OSIgeTI9IjM0MS4zNTk0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjgiIHg9IjUiIHk9Ijg0Ljk5NTEiPuyyoOyImDwvdGV4dD48ZWxsaXBzZSBjeD0iMjIiIGN5PSIxNSIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxNXh1a3FxZWk4djg4KSIgcng9IjgiIHJ5PSI4IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48cGF0aCBkPSJNMjIsMjMgTDIyLDUwIE05LDMxIEwzNSwzMSBNMjIsNTAgTDksNjUgTTIyLDUwIEwzNSw2NSAiIGZpbGw9Im5vbmUiIGZpbHRlcj0idXJsKCNmMTV4dWtxcWVpOHY4OCkiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI4IiB4PSI1IiB5PSIzNTMuMzU0NSI+7LKg7IiYPC90ZXh0PjxlbGxpcHNlIGN4PSIyMiIgY3k9IjM2Ni42NTYzIiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZjE1eHVrcXFlaTh2ODgpIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjxwYXRoIGQ9Ik0yMiwzNzQuNjU2MyBMMjIsNDAxLjY1NjMgTTksMzgyLjY1NjMgTDM1LDM4Mi42NTYzIE0yMiw0MDEuNjU2MyBMOSw0MTYuNjU2MyBNMjIsNDAxLjY1NjMgTDM1LDQxNi42NTYzICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2YxNXh1a3FxZWk4djg4KSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzciIHg9IjI4OS41IiB5PSI4NC45OTUxIj7qs4TsoowxPC90ZXh0PjxwYXRoIGQ9Ik0yOTMsMzYgQzI5MywyNiAzMTEsMjYgMzExLDI2IEMzMTEsMjYgMzI5LDI2IDMyOSwzNiBMMzI5LDYyIEMzMjksNzIgMzExLDcyIDMxMSw3MiBDMzExLDcyIDI5Myw3MiAyOTMsNjIgTDI5MywzNiAiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMTV4dWtxcWVpOHY4OCkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxwYXRoIGQ9Ik0yOTMsMzYgQzI5Myw0NiAzMTEsNDYgMzExLDQ2IEMzMTEsNDYgMzI5LDQ2IDMyOSwzNiAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM3IiB4PSIyODkuNSIgeT0iMzUzLjM1NDUiPuqzhOyijDE8L3RleHQ+PHBhdGggZD0iTTI5MywzNjYuNjU2MyBDMjkzLDM1Ni42NTYzIDMxMSwzNTYuNjU2MyAzMTEsMzU2LjY1NjMgQzMxMSwzNTYuNjU2MyAzMjksMzU2LjY1NjMgMzI5LDM2Ni42NTYzIEwzMjksMzkyLjY1NjMgQzMyOSw0MDIuNjU2MyAzMTEsNDAyLjY1NjMgMzExLDQwMi42NTYzIEMzMTEsNDAyLjY1NjMgMjkzLDQwMi42NTYzIDI5MywzOTIuNjU2MyBMMjkzLDM2Ni42NTYzICIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2YxNXh1a3FxZWk4djg4KSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PHBhdGggZD0iTTI5MywzNjYuNjU2MyBDMjkzLDM3Ni42NTYzIDMxMSwzNzYuNjU2MyAzMTEsMzc2LjY1NjMgQzMxMSwzNzYuNjU2MyAzMjksMzc2LjY1NjMgMzI5LDM2Ni42NTYzICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzYiIHg9IjM0Mi41IiB5PSI4NC45OTUxIj7qs4TsoowyPC90ZXh0PjxwYXRoIGQ9Ik0zNDUuNSwzNiBDMzQ1LjUsMjYgMzYzLjUsMjYgMzYzLjUsMjYgQzM2My41LDI2IDM4MS41LDI2IDM4MS41LDM2IEwzODEuNSw2MiBDMzgxLjUsNzIgMzYzLjUsNzIgMzYzLjUsNzIgQzM2My41LDcyIDM0NS41LDcyIDM0NS41LDYyIEwzNDUuNSwzNiAiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMTV4dWtxcWVpOHY4OCkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxwYXRoIGQ9Ik0zNDUuNSwzNiBDMzQ1LjUsNDYgMzYzLjUsNDYgMzYzLjUsNDYgQzM2My41LDQ2IDM4MS41LDQ2IDM4MS41LDM2ICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzYiIHg9IjM0Mi41IiB5PSIzNTMuMzU0NSI+6rOE7KKMMjwvdGV4dD48cGF0aCBkPSJNMzQ1LjUsMzY2LjY1NjMgQzM0NS41LDM1Ni42NTYzIDM2My41LDM1Ni42NTYzIDM2My41LDM1Ni42NTYzIEMzNjMuNSwzNTYuNjU2MyAzODEuNSwzNTYuNjU2MyAzODEuNSwzNjYuNjU2MyBMMzgxLjUsMzkyLjY1NjMgQzM4MS41LDQwMi42NTYzIDM2My41LDQwMi42NTYzIDM2My41LDQwMi42NTYzIEMzNjMuNSw0MDIuNjU2MyAzNDUuNSw0MDIuNjU2MyAzNDUuNSwzOTIuNjU2MyBMMzQ1LjUsMzY2LjY1NjMgIiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZjE1eHVrcXFlaTh2ODgpIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48cGF0aCBkPSJNMzQ1LjUsMzY2LjY1NjMgQzM0NS41LDM3Ni42NTYzIDM2My41LDM3Ni42NTYzIDM2My41LDM3Ni42NTYzIEMzNjMuNSwzNzYuNjU2MyAzODEuNSwzNzYuNjU2MyAzODEuNSwzNjYuNjU2MyAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQyIiB4PSI3MzguNSIgeT0iODQuOTk1MSI+7JiB7Iud7J20PC90ZXh0PjxlbGxpcHNlIGN4PSI3NjIuNSIgY3k9IjE1IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZjE1eHVrcXFlaTh2ODgpIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjxwYXRoIGQ9Ik03NjIuNSwyMyBMNzYyLjUsNTAgTTc0OS41LDMxIEw3NzUuNSwzMSBNNzYyLjUsNTAgTDc0OS41LDY1IE03NjIuNSw1MCBMNzc1LjUsNjUgIiBmaWxsPSJub25lIiBmaWx0ZXI9InVybCgjZjE1eHVrcXFlaTh2ODgpIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MiIgeD0iNzM4LjUiIHk9IjM1My4zNTQ1Ij7smIHsi53snbQ8L3RleHQ+PGVsbGlwc2UgY3g9Ijc2Mi41IiBjeT0iMzY2LjY1NjMiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmMTV4dWtxcWVpOHY4OCkiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHBhdGggZD0iTTc2Mi41LDM3NC42NTYzIEw3NjIuNSw0MDEuNjU2MyBNNzQ5LjUsMzgyLjY1NjMgTDc3NS41LDM4Mi42NTYzIE03NjIuNSw0MDEuNjU2MyBMNzQ5LjUsNDE2LjY1NjMgTTc2Mi41LDQwMS42NTYzIEw3NzUuNSw0MTYuNjU2MyAiIGZpbGw9Im5vbmUiIGZpbHRlcj0idXJsKCNmMTV4dWtxcWVpOHY4OCkiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMjk5LDExNS40Mjk3LDMwOSwxMTkuNDI5NywyOTksMTIzLjQyOTcsMzAzLDExOS40Mjk3IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSIyMiIgeDI9IjMwNSIgeTE9IjExOS40Mjk3IiB5Mj0iMTE5LjQyOTciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNjUiIHg9IjI5IiB5PSIxMTQuMzYzOCI+c2VsZWN0IGJhbGFuY2UgZnJvbSBhY2NvdW50cyBmcm9tIGlkID0gMTwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjMzLDE0NC41NjI1LDIzLDE0OC41NjI1LDMzLDE1Mi41NjI1LDI5LDE0OC41NjI1IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSIyNyIgeDI9IjMxMCIgeTE9IjE0OC41NjI1IiB5Mj0iMTQ4LjU2MjUiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNCIgeD0iMzkiIHk9IjE0My40OTY2Ij41MDA8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzMjIsMTczLjY5NTMsMzEyLDE3Ny42OTUzLDMyMiwxODEuNjk1MywzMTgsMTc3LjY5NTMiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjMxNiIgeDI9Ijc2MS41IiB5MT0iMTc3LjY5NTMiIHkyPSIxNzcuNjk1MyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM4MCIgeD0iMzI4IiB5PSIxNzIuNjI5NCI+dXBkYXRlIGFjY291bnRzIHNldCBiYWxhbmNlID0gYmFsYW5jZSArIDEwMCB3aGVyZSBpZCA9IDE8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI3NTAuNSwyMDIuODI4MSw3NjAuNSwyMDYuODI4MSw3NTAuNSwyMTAuODI4MSw3NTQuNSwyMDYuODI4MSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMzExIiB4Mj0iNzU2LjUiIHkxPSIyMDYuODI4MSIgeTI9IjIwNi44MjgxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjQiIHg9IjMxOCIgeT0iMjAxLjc2MjIiPjYwMDwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjM3NC41LDIzMS45NjA5LDM2NC41LDIzNS45NjA5LDM3NC41LDIzOS45NjA5LDM3MC41LDIzNS45NjA5IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSIzNjguNSIgeDI9Ijc2MS41IiB5MT0iMjM1Ljk2MDkiIHkyPSIyMzUuOTYwOSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM3NSIgeD0iMzgwLjUiIHk9IjIzMC44OTUiPnVwZGF0ZSBhY2NvdW50cyBzZXQgYmFsYW5jZSA9IGJhbGFuY2UgLSAxMDAgd2hlcmUgaWQgPSAyPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iNzUwLjUsMjYxLjA5MzgsNzYwLjUsMjY1LjA5MzgsNzUwLjUsMjY5LjA5MzgsNzU0LjUsMjY1LjA5MzgiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjM2My41IiB4Mj0iNzU2LjUiIHkxPSIyNjUuMDkzOCIgeTI9IjI2NS4wOTM4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjQiIHg9IjM3MC41IiB5PSIyNjAuMDI3OCI+NDAwPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMzUxLjUsMjkwLjIyNjYsMzYxLjUsMjk0LjIyNjYsMzUxLjUsMjk4LjIyNjYsMzU1LjUsMjk0LjIyNjYiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjIyIiB4Mj0iMzU3LjUiIHkxPSIyOTQuMjI2NiIgeTI9IjI5NC4yMjY2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjY1IiB4PSIyOSIgeT0iMjg5LjE2MDYiPnNlbGVjdCBiYWxhbmNlIGZyb20gYWNjb3VudHMgZnJvbSBpZCA9IDI8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzMywzMTkuMzU5NCwyMywzMjMuMzU5NCwzMywzMjcuMzU5NCwyOSwzMjMuMzU5NCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMjciIHgyPSIzNjIuNSIgeTE9IjMyMy4zNTk0IiB5Mj0iMzIzLjM1OTQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNCIgeD0iMzkiIHk9IjMxOC4yOTM1Ij40MDA8L3RleHQ+PCEtLU1ENT1bYmU5OGQ4YjdmZWJiY2E5YzkxNzE0NDFmOTU0Y2FlMTNdCkBzdGFydHVtbA0KYWN0b3Ig7LKg7IiYDQpkYXRhYmFzZSDqs4TsoowxDQpkYXRhYmFzZSDqs4TsoowyDQphY3RvciDsmIHsi53snbQNCg0K7LKg7IiYIC0+IOqzhOyijDE6IHNlbGVjdCBiYWxhbmNlIGZyb20gYWNjb3VudHMgZnJvbSBpZCA9IDENCuqzhOyijDEgLT4g7LKg7IiYOiA1MDANCg0K7JiB7Iud7J20IC0+IOqzhOyijDE6IHVwZGF0ZSBhY2NvdW50cyBzZXQgYmFsYW5jZSA9IGJhbGFuY2UgKyAxMDAgd2hlcmUgaWQgPSAxDQrqs4TsoowxIC0+IOyYgeyLneydtDogNjAwDQoNCuyYgeyLneydtCAtPiDqs4TsoowyOiB1cGRhdGUgYWNjb3VudHMgc2V0IGJhbGFuY2UgPSBiYWxhbmNlIC0gMTAwIHdoZXJlIGlkID0gMg0K6rOE7KKMMiAtPiDsmIHsi53snbQ6IDQwMA0KDQrssqDsiJggLT4g6rOE7KKMMjogc2VsZWN0IGJhbGFuY2UgZnJvbSBhY2NvdW50cyBmcm9tIGlkID0gMg0K6rOE7KKMMiAtPiDssqDsiJg6IDQwMA0KQGVuZHVtbA0KClBsYW50VU1MIHZlcnNpb24gMS4yMDIxLjEwYmV0YTIoVW5rbm93biBjb21waWxlIHRpbWUpCihHUEwgc291cmNlIGRpc3RyaWJ1dGlvbikKSmF2YSBSdW50aW1lOiBKYXZhKFRNKSBTRSBSdW50aW1lIEVudmlyb25tZW50CkpWTTogSmF2YSBIb3RTcG90KFRNKSA2NC1CaXQgU2VydmVyIFZNCkRlZmF1bHQgRW5jb2Rpbmc6IFVURi04Ckxhbmd1YWdlOiBlbgpDb3VudHJ5OiBVUwotLT48L2c+PC9zdmc+'>
<blockquote>
<p>위 예제에서 일시적으로 철수는 계좌에서 100원이 갑자기 사라진처럼 보일 수 있다.<br>영식이가 100원을 계좌1에서 꺼내 계좌2로 보내는 트랜잭션을 수행했고<br>철수는 격리 수준에 따라 과거 커밋된 값인 계좌 1의 500원과 계좌2의 400원을 읽어 총액 1000원에서 900원으로 100원이 사라진처럼 보일 수 있다.</p>
</blockquote>
<ul>
<li>위와 같이 일시적으로 현상을 가리켜 비반복 읽기(Non-Repeatable-Read) 혹은 읽기 쓰큐(Read-Skew)라고 부른다. 커밋 후 읽기(READ_COMMITTED)에서 읽기 스큐는 받아들일 수 있는 것으로 여겨지지만 비즈니스마다 이런 일시적인 비일관성을 감내할 수 없는 경우도 존재한다.</li>
</ul>
<h3 id="스냅샷-격리와-반복-읽기"><a href="#스냅샷-격리와-반복-읽기" class="headerlink" title="스냅샷 격리와 반복 읽기"></a>스냅샷 격리와 반복 읽기</h3><ul>
<li>위 계좌 잔고 예제의 문제에서 일관된 읽기를 하지 못하는 것의 해결책으로 <code>스냅숏 격리</code>를 사용할 수 있다.</li>
<li>각 트랜잭션은 데이터베이스의 일관된 스냅샷으로부터 읽는다. 즉 트랜잭션은 시작할 때 데이터베이스에 커밋된 상태였던 모든 데이터를 본다. 데이터가 나중에 다른 트랜잭션에 의해 바뀌더라도 각 트랜잭션은 특정한 시점의 과거 데이터를 볼 뿐이다.</li>
<li>스냅샷 격리는 널리 쓰이는 기능으로 PostgreSQL, InnoDB 엔진을 사용하는 Oracle, MySQL, SQL_Server에서 지원된다.</li>
</ul>
<h4 id="스냅샷-격리-구현"><a href="#스냅샷-격리-구현" class="headerlink" title="스냅샷 격리 구현"></a>스냅샷 격리 구현</h4><ul>
<li>커밋 후 읽기(READ_COMMITTED)에서처럼 더티 쓰기를 방지하기 위해 쓰기 잠금을 사용한다.</li>
<li>같은 객체에 쓰기를 하는 경우 락을 획득한 트랜잭션에 먼저 진행하고 다른 트랜잭션은 앞의 트랜잭션이 락을 풀어줄때까지 기다려야 한다는 이야기다.</li>
<li>하지만, <em><strong>읽을 떄는 아무 잠금이 필요 없다. 읽는 쪽에서 쓰는 쪽을 결코 차단하지 않고 쓰는 쪽에서 읽는 쪽을 결코 차단하지 않는다.</strong></em></li>
<li>스냅샷 격리를 지원하는 저장소 엔진은 보통 커밋 후 읽기 격리를 위해서 MVCC를 사용한다.<blockquote>
<p><strong>MVCC(Multi-Version-Concurrency-Control)</strong><br>데이터베이스마다 커밋된 여러 버젼을 유지하며 진행 중인 여러 트랜잭션에서 서로 다른 시점의 데이터베이스 상태를 봐야 할 수도 있기 때문. 데이터베이스가 객체의 여러 버전을 함께 유지하므로 이 기법은 다중 버젼 동시성 제어 라고 한다.</p>
</blockquote>
</li>
</ul>
<img src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iOTE4cHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo5MTJweDtoZWlnaHQ6OTE4cHg7YmFja2dyb3VuZDojRkZGRkZGOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgOTEyIDkxOCIgd2lkdGg9IjkxMnB4IiB6b29tQW5kUGFuPSJtYWduaWZ5Ij48ZGVmcz48ZmlsdGVyIGhlaWdodD0iMzAwJSIgaWQ9ImZvcHNwbjZpNmhxbjQiIHdpZHRoPSIzMDAlIiB4PSItMSIgeT0iLTEiPjxmZUdhdXNzaWFuQmx1ciByZXN1bHQ9ImJsdXJPdXQiIHN0ZERldmlhdGlvbj0iMi4wIi8+PGZlQ29sb3JNYXRyaXggaW49ImJsdXJPdXQiIHJlc3VsdD0iYmx1ck91dDIiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAuNCAwIi8+PGZlT2Zmc2V0IGR4PSI0LjAiIGR5PSI0LjAiIGluPSJibHVyT3V0MiIgcmVzdWx0PSJibHVyT3V0MyIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImJsdXJPdXQzIiBtb2RlPSJub3JtYWwiLz48L2ZpbHRlcj48L2RlZnM+PGc+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgZmlsdGVyPSJ1cmwoI2ZvcHNwbjZpNmhxbjQpIiBoZWlnaHQ9IjM4MC4xMjUiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgd2lkdGg9IjEwIiB4PSIzOSIgeT0iMjQzLjM5MDYiLz48cmVjdCBmaWxsPSIjRkZGRkZGIiBmaWx0ZXI9InVybCgjZm9wc3BuNmk2aHFuNCkiIGhlaWdodD0iMjYzLjU5MzgiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgd2lkdGg9IjEwIiB4PSI4NjciIHk9IjMwMS42NTYzIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7c3Ryb2tlLWRhc2hhcnJheTo1LjAsNS4wOyIgeDE9IjQ0IiB4Mj0iNDQiIHkxPSIxMDQuNTkzOCIgeTI9IjgxNy43MTA5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7c3Ryb2tlLWRhc2hhcnJheTo1LjAsNS4wOyIgeDE9IjMzMi41IiB4Mj0iMzMyLjUiIHkxPSIxMDQuNTkzOCIgeTI9IjgxNy43MTA5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7c3Ryb2tlLWRhc2hhcnJheTo1LjAsNS4wOyIgeDE9IjQ2OCIgeDI9IjQ2OCIgeTE9IjEwNC41OTM4IiB5Mj0iODE3LjcxMDkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjUuMCw1LjA7IiB4MT0iODcxLjUiIHgyPSI4NzEuNSIgeTE9IjEwNC41OTM4IiB5Mj0iODE3LjcxMDkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyOCIgeD0iMjciIHk9Ijg0Ljk5NTEiPuyyoOyImDwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3MiIgeD0iNSIgeT0iMTAxLjI5MiI+KHRyeElkPTEyKTwvdGV4dD48ZWxsaXBzZSBjeD0iNDQiIGN5PSIxNSIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2ZvcHNwbjZpNmhxbjQpIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjxwYXRoIGQ9Ik00NCwyMyBMNDQsNTAgTTMxLDMxIEw1NywzMSBNNDQsNTAgTDMxLDY1IE00NCw1MCBMNTcsNjUgIiBmaWxsPSJub25lIiBmaWx0ZXI9InVybCgjZm9wc3BuNmk2aHFuNCkiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6Mi4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI4IiB4PSIyNyIgeT0iODI5LjcwNjEiPuyyoOyImDwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3MiIgeD0iNSIgeT0iODQ2LjAwMjkiPih0cnhJZD0xMik8L3RleHQ+PGVsbGlwc2UgY3g9IjQ0IiBjeT0iODU5LjMwNDciIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmb3BzcG42aTZocW40KSIgcng9IjgiIHJ5PSI4IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48cGF0aCBkPSJNNDQsODY3LjMwNDcgTDQ0LDg5NC4zMDQ3IE0zMSw4NzUuMzA0NyBMNTcsODc1LjMwNDcgTTQ0LDg5NC4zMDQ3IEwzMSw5MDkuMzA0NyBNNDQsODk0LjMwNDcgTDU3LDkwOS4zMDQ3ICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2ZvcHNwbjZpNmhxbjQpIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNyIgeD0iMzExLjUiIHk9IjEwMS4yOTIiPuqzhOyijDE8L3RleHQ+PHBhdGggZD0iTTMxNSw1Mi4yOTY5IEMzMTUsNDIuMjk2OSAzMzMsNDIuMjk2OSAzMzMsNDIuMjk2OSBDMzMzLDQyLjI5NjkgMzUxLDQyLjI5NjkgMzUxLDUyLjI5NjkgTDM1MSw3OC4yOTY5IEMzNTEsODguMjk2OSAzMzMsODguMjk2OSAzMzMsODguMjk2OSBDMzMzLDg4LjI5NjkgMzE1LDg4LjI5NjkgMzE1LDc4LjI5NjkgTDMxNSw1Mi4yOTY5ICIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2ZvcHNwbjZpNmhxbjQpIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48cGF0aCBkPSJNMzE1LDUyLjI5NjkgQzMxNSw2Mi4yOTY5IDMzMyw2Mi4yOTY5IDMzMyw2Mi4yOTY5IEMzMzMsNjIuMjk2OSAzNTEsNjIuMjk2OSAzNTEsNTIuMjk2OSAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM3IiB4PSIzMTEuNSIgeT0iODI5LjcwNjEiPuqzhOyijDE8L3RleHQ+PHBhdGggZD0iTTMxNSw4NDMuMDA3OCBDMzE1LDgzMy4wMDc4IDMzMyw4MzMuMDA3OCAzMzMsODMzLjAwNzggQzMzMyw4MzMuMDA3OCAzNTEsODMzLjAwNzggMzUxLDg0My4wMDc4IEwzNTEsODY5LjAwNzggQzM1MSw4NzkuMDA3OCAzMzMsODc5LjAwNzggMzMzLDg3OS4wMDc4IEMzMzMsODc5LjAwNzggMzE1LDg3OS4wMDc4IDMxNSw4NjkuMDA3OCBMMzE1LDg0My4wMDc4ICIgZmlsbD0iI0ZFRkVDRSIgZmlsdGVyPSJ1cmwoI2ZvcHNwbjZpNmhxbjQpIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48cGF0aCBkPSJNMzE1LDg0My4wMDc4IEMzMTUsODUzLjAwNzggMzMzLDg1My4wMDc4IDMzMyw4NTMuMDA3OCBDMzMzLDg1My4wMDc4IDM1MSw4NTMuMDA3OCAzNTEsODQzLjAwNzggIiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNiIgeD0iNDQ3IiB5PSIxMDEuMjkyIj7qs4TsoowyPC90ZXh0PjxwYXRoIGQ9Ik00NTAsNTIuMjk2OSBDNDUwLDQyLjI5NjkgNDY4LDQyLjI5NjkgNDY4LDQyLjI5NjkgQzQ2OCw0Mi4yOTY5IDQ4Niw0Mi4yOTY5IDQ4Niw1Mi4yOTY5IEw0ODYsNzguMjk2OSBDNDg2LDg4LjI5NjkgNDY4LDg4LjI5NjkgNDY4LDg4LjI5NjkgQzQ2OCw4OC4yOTY5IDQ1MCw4OC4yOTY5IDQ1MCw3OC4yOTY5IEw0NTAsNTIuMjk2OSAiIGZpbGw9IiNGRUZFQ0UiIGZpbHRlcj0idXJsKCNmb3BzcG42aTZocW40KSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PHBhdGggZD0iTTQ1MCw1Mi4yOTY5IEM0NTAsNjIuMjk2OSA0NjgsNjIuMjk2OSA0NjgsNjIuMjk2OSBDNDY4LDYyLjI5NjkgNDg2LDYyLjI5NjkgNDg2LDUyLjI5NjkgIiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNiIgeD0iNDQ3IiB5PSI4MjkuNzA2MSI+6rOE7KKMMjwvdGV4dD48cGF0aCBkPSJNNDUwLDg0My4wMDc4IEM0NTAsODMzLjAwNzggNDY4LDgzMy4wMDc4IDQ2OCw4MzMuMDA3OCBDNDY4LDgzMy4wMDc4IDQ4Niw4MzMuMDA3OCA0ODYsODQzLjAwNzggTDQ4Niw4NjkuMDA3OCBDNDg2LDg3OS4wMDc4IDQ2OCw4NzkuMDA3OCA0NjgsODc5LjAwNzggQzQ2OCw4NzkuMDA3OCA0NTAsODc5LjAwNzggNDUwLDg2OS4wMDc4IEw0NTAsODQzLjAwNzggIiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZm9wc3BuNmk2aHFuNCkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxwYXRoIGQ9Ik00NTAsODQzLjAwNzggQzQ1MCw4NTMuMDA3OCA0NjgsODUzLjAwNzggNDY4LDg1My4wMDc4IEM0NjgsODUzLjAwNzggNDg2LDg1My4wMDc4IDQ4Niw4NDMuMDA3OCAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQyIiB4PSI4NDgiIHk9Ijg0Ljk5NTEiPuyYgeyLneydtDwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3MyIgeD0iODMyLjUiIHk9IjEwMS4yOTIiPih0cnhJZD0xMyk8L3RleHQ+PGVsbGlwc2UgY3g9Ijg3MiIgY3k9IjE1IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZm9wc3BuNmk2aHFuNCkiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHBhdGggZD0iTTg3MiwyMyBMODcyLDUwIE04NTksMzEgTDg4NSwzMSBNODcyLDUwIEw4NTksNjUgTTg3Miw1MCBMODg1LDY1ICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2ZvcHNwbjZpNmhxbjQpIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MiIgeD0iODQ4IiB5PSI4MjkuNzA2MSI+7JiB7Iud7J20PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjczIiB4PSI4MzIuNSIgeT0iODQ2LjAwMjkiPih0cnhJZD0xMyk8L3RleHQ+PGVsbGlwc2UgY3g9Ijg3MiIgY3k9Ijg1OS4zMDQ3IiBmaWxsPSIjRkVGRUNFIiBmaWx0ZXI9InVybCgjZm9wc3BuNmk2aHFuNCkiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoyLjA7Ii8+PHBhdGggZD0iTTg3Miw4NjcuMzA0NyBMODcyLDg5NC4zMDQ3IE04NTksODc1LjMwNDcgTDg4NSw4NzUuMzA0NyBNODcyLDg5NC4zMDQ3IEw4NTksOTA5LjMwNDcgTTg3Miw4OTQuMzA0NyBMODg1LDkwOS4zMDQ3ICIgZmlsbD0ibm9uZSIgZmlsdGVyPSJ1cmwoI2ZvcHNwbjZpNmhxbjQpIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjIuMDsiLz48cmVjdCBmaWxsPSIjRkZGRkZGIiBmaWx0ZXI9InVybCgjZm9wc3BuNmk2aHFuNCkiIGhlaWdodD0iMzgwLjEyNSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB3aWR0aD0iMTAiIHg9IjM5IiB5PSIyNDMuMzkwNiIvPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGZpbHRlcj0idXJsKCNmb3BzcG42aTZocW40KSIgaGVpZ2h0PSIyNjMuNTkzOCIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB3aWR0aD0iMTAiIHg9Ijg2NyIgeT0iMzAxLjY1NjMiLz48cGF0aCBkPSJNMjAzLDExOS41OTM4IEwyMDMsMjEyLjU5MzggTDMyNCwyMTIuNTkzOCBMMzI0LDEyOS41OTM4IEwzMTQsMTE5LjU5MzggTDIwMywxMTkuNTkzOCAiIGZpbGw9IiNGQkZCNzciIGZpbHRlcj0idXJsKCNmb3BzcG42aTZocW40KSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTMxNCwxMTkuNTkzOCBMMzE0LDEyOS41OTM4IEwzMjQsMTI5LjU5MzggTDMxNCwxMTkuNTkzOCAiIGZpbGw9IiNGQkZCNzciIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4NCIgeD0iMjA5IiB5PSIxMzYuNjYwNiI+6rOE7KKMMSDsiqTrg4Xsg7c8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMjA0IiB4Mj0iMzIzIiB5MT0iMTM5LjcyNjYiIHkyPSIxMzkuNzI2NiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk1IiB4PSIyMDkiIHk9IjE1NS43OTM1Ij5jcmVhdGVkIGJ5ID0gMzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDAiIHg9IjIwOSIgeT0iMTcwLjkyNjMiPmRlbGV0ZWQgYnkgPSBuaWw8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzciIHg9IjIwOSIgeT0iMTg2LjA1OTEiPmlkID0gMTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4NCIgeD0iMjA5IiB5PSIyMDEuMTkxOSI+YmFsYW5jZT01MDA8L3RleHQ+PHBhdGggZD0iTTQ3MywxMTkuNTkzOCBMNDczLDIxMi41OTM4IEw1OTQsMjEyLjU5MzggTDU5NCwxMjkuNTkzOCBMNTg0LDExOS41OTM4IEw0NzMsMTE5LjU5MzggIiBmaWxsPSIjRkJGQjc3IiBmaWx0ZXI9InVybCgjZm9wc3BuNmk2aHFuNCkiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik01ODQsMTE5LjU5MzggTDU4NCwxMjkuNTkzOCBMNTk0LDEyOS41OTM4IEw1ODQsMTE5LjU5MzggIiBmaWxsPSIjRkJGQjc3IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODQiIHg9IjQ3OSIgeT0iMTM2LjY2MDYiPuqzhOyijDIg7Iqk64OF7IO3PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjQ3NCIgeDI9IjU5MyIgeTE9IjEzOS43MjY2IiB5Mj0iMTM5LjcyNjYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5NSIgeD0iNDc5IiB5PSIxNTUuNzkzNSI+Y3JlYXRlZCBieSA9IDU8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAwIiB4PSI0NzkiIHk9IjE3MC45MjYzIj5kZWxldGVkIGJ5ID0gbmlsPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM3IiB4PSI0NzkiIHk9IjE4Ni4wNTkxIj5pZCA9IDI8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODQiIHg9IjQ3OSIgeT0iMjAxLjE5MTkiPmJhbGFuY2U9NTAwPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMzIxLDIzOS4zOTA2LDMzMSwyNDMuMzkwNiwzMjEsMjQ3LjM5MDYsMzI1LDI0My4zOTA2IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSI0OSIgeDI9IjMyNyIgeTE9IjI0My4zOTA2IiB5Mj0iMjQzLjM5MDYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNjUiIHg9IjU2IiB5PSIyMzguMzI0NyI+c2VsZWN0IGJhbGFuY2UgZnJvbSBhY2NvdW50cyBmcm9tIGlkID0gMTwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjYwLDI2OC41MjM0LDUwLDI3Mi41MjM0LDYwLDI3Ni41MjM0LDU2LDI3Mi41MjM0IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSI1NCIgeDI9IjMzMiIgeTE9IjI3Mi41MjM0IiB5Mj0iMjcyLjUyMzQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNCIgeD0iNjYiIHk9IjI2Ny40NTc1Ij41MDA8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzNDQsMjk3LjY1NjMsMzM0LDMwMS42NTYzLDM0NCwzMDUuNjU2MywzNDAsMzAxLjY1NjMiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjMzOCIgeDI9Ijg2NiIgeTE9IjMwMS42NTYzIiB5Mj0iMzAxLjY1NjMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzODAiIHg9IjM1MCIgeT0iMjk2LjU5MDMiPnVwZGF0ZSBhY2NvdW50cyBzZXQgYmFsYW5jZSA9IGJhbGFuY2UgKyAxMDAgd2hlcmUgaWQgPSAxPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iODU1LDMyNi43ODkxLDg2NSwzMzAuNzg5MSw4NTUsMzM0Ljc4OTEsODU5LDMzMC43ODkxIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSIzMzMiIHgyPSI4NjEiIHkxPSIzMzAuNzg5MSIgeTI9IjMzMC43ODkxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTgiIHg9IjM0MCIgeT0iMzI1LjcyMzEiPk9LPC90ZXh0PjxwYXRoIGQ9Ik0yMDAsMzQzLjc4OTEgTDIwMCw1MDUuNzg5MSBMMzI0LDUwNS43ODkxIEwzMjQsMzUzLjc4OTEgTDMxNCwzNDMuNzg5MSBMMjAwLDM0My43ODkxICIgZmlsbD0iI0ZCRkI3NyIgZmlsdGVyPSJ1cmwoI2ZvcHNwbjZpNmhxbjQpIiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMzE0LDM0My43ODkxIEwzMTQsMzUzLjc4OTEgTDMyNCwzNTMuNzg5MSBMMzE0LDM0My43ODkxICIgZmlsbD0iI0ZCRkI3NyIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg0IiB4PSIyMDYiIHk9IjM2MC44NTYiPuqzhOyijDEg7Iqk64OF7IO3PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjIwMSIgeDI9IjMyMyIgeTE9IjM2My45MjE5IiB5Mj0iMzYzLjkyMTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5NSIgeD0iMjA2IiB5PSIzNzkuOTg4OCI+Y3JlYXRlZCBieSA9IDM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAyIiB4PSIyMDYiIHk9IjM5NS4xMjE2Ij5kZWxldGVkIGJ5ID0gMTM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzciIHg9IjIwNiIgeT0iNDEwLjI1NDQiPmlkID0gMTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4NCIgeD0iMjA2IiB5PSI0MjUuMzg3MiI+YmFsYW5jZT01MDA8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iMjAxIiB4Mj0iMzIzIiB5MT0iNDMyLjQ1MzEiIHkyPSI0MzIuNDUzMSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMyIgeD0iMjA2IiB5PSI0NDguNTIiPmNyZWF0ZWQgYnkgPSAxMzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDAiIHg9IjIwNiIgeT0iNDYzLjY1MjgiPmRlbGV0ZWQgYnkgPSBuaWw8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzciIHg9IjIwNiIgeT0iNDc4Ljc4NTYiPmlkID0gMTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4NCIgeD0iMjA2IiB5PSI0OTMuOTE4NSI+YmFsYW5jZT02MDA8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSI0NzksNTMyLjExNzIsNDY5LDUzNi4xMTcyLDQ3OSw1NDAuMTE3Miw0NzUsNTM2LjExNzIiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjQ3MyIgeDI9Ijg2NiIgeTE9IjUzNi4xMTcyIiB5Mj0iNTM2LjExNzIiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNzUiIHg9IjQ4NSIgeT0iNTMxLjA1MTMiPnVwZGF0ZSBhY2NvdW50cyBzZXQgYmFsYW5jZSA9IGJhbGFuY2UgLSAxMDAgd2hlcmUgaWQgPSAyPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iODYwLDU2MS4yNSw4NzAsNTY1LjI1LDg2MCw1NjkuMjUsODY0LDU2NS4yNSIgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojQTgwMDM2O3N0cm9rZS13aWR0aDoxLjA7IiB4MT0iNDY4IiB4Mj0iODY2IiB5MT0iNTY1LjI1IiB5Mj0iNTY1LjI1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTgiIHg9IjQ3NSIgeT0iNTYwLjE4NDEiPk9LPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iNDU2LDU5MC4zODI4LDQ2Niw1OTQuMzgyOCw0NTYsNTk4LjM4MjgsNDYwLDU5NC4zODI4IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSI0OSIgeDI9IjQ2MiIgeTE9IjU5NC4zODI4IiB5Mj0iNTk0LjM4MjgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNjUiIHg9IjU2IiB5PSI1ODkuMzE2OSI+c2VsZWN0IGJhbGFuY2UgZnJvbSBhY2NvdW50cyBmcm9tIGlkID0gMjwvdGV4dD48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjU1LDYxOS41MTU2LDQ1LDYyMy41MTU2LDU1LDYyNy41MTU2LDUxLDYyMy41MTU2IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSI0OSIgeDI9IjQ2NyIgeTE9IjYyMy41MTU2IiB5Mj0iNjIzLjUxNTYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNCIgeD0iNjEiIHk9IjYxOC40NDk3Ij41MDA8L3RleHQ+PHBhdGggZD0iTTQ3Myw2MzYuNTE1NiBMNDczLDc5OC41MTU2IEw1OTcsNzk4LjUxNTYgTDU5Nyw2NDYuNTE1NiBMNTg3LDYzNi41MTU2IEw0NzMsNjM2LjUxNTYgIiBmaWxsPSIjRkJGQjc3IiBmaWx0ZXI9InVybCgjZm9wc3BuNmk2aHFuNCkiIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik01ODcsNjM2LjUxNTYgTDU4Nyw2NDYuNTE1NiBMNTk3LDY0Ni41MTU2IEw1ODcsNjM2LjUxNTYgIiBmaWxsPSIjRkJGQjc3IiBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODQiIHg9IjQ3OSIgeT0iNjUzLjU4MjUiPuqzhOyijDIg7Iqk64OF7IO3PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6I0E4MDAzNjtzdHJva2Utd2lkdGg6MS4wOyIgeDE9IjQ3NCIgeDI9IjU5NiIgeTE9IjY1Ni42NDg0IiB5Mj0iNjU2LjY0ODQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5NSIgeD0iNDc5IiB5PSI2NzIuNzE1MyI+Y3JlYXRlZCBieSA9IDU8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAyIiB4PSI0NzkiIHk9IjY4Ny44NDgxIj5kZWxldGVkIGJ5ID0gMTM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzciIHg9IjQ3OSIgeT0iNzAyLjk4MSI+aWQgPSAyPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg0IiB4PSI0NzkiIHk9IjcxOC4xMTM4Ij5iYWxhbmNlPTUwMDwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiNBODAwMzY7c3Ryb2tlLXdpZHRoOjEuMDsiIHgxPSI0NzQiIHgyPSI1OTYiIHkxPSI3MjUuMTc5NyIgeTI9IjcyNS4xNzk3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAzIiB4PSI0NzkiIHk9Ijc0MS4yNDY2Ij5jcmVhdGVkIGJ5ID0gMTM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAwIiB4PSI0NzkiIHk9Ijc1Ni4zNzk0Ij5kZWxldGVkIGJ5ID0gbmlsPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI5IiB4PSI0NzkiIHk9Ijc3MS41MTIyIj5pZD0yPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg0IiB4PSI0NzkiIHk9Ijc4Ni42NDUiPmJhbGFuY2U9NDAwPC90ZXh0PjwhLS1NRDU9WzgxOTU0OTczOTA5OTdjNzIzMTAzOGEwZWZhZTE5ZDFkXQpAc3RhcnR1bWwNCmFjdG9yICLssqDsiJhcbih0cnhJZD0xMikiIGFzIOyyoOyImA0KZGF0YWJhc2Ug6rOE7KKMMQ0KZGF0YWJhc2Ug6rOE7KKMMg0KYWN0b3IgIuyYgeyLneydtFxuKHRyeElkPTEzKSIgYXMg7JiB7Iud7J20DQoNCm5vdGUgbGVmdCBvZiDqs4TsoowxOiAqKuqzhOyijDEg7Iqk64OF7IO3Kipcbi0gLVxuY3JlYXRlZCBieSA9IDNcbmRlbGV0ZWQgYnkgPSBuaWxcbmlkID0gMVxuYmFsYW5jZT01MDAgDQovIG5vdGUgcmlnaHQgb2Yg6rOE7KKMMjogKirqs4TsoowyIOyKpOuDheyDtyoqXG4tIC1cbmNyZWF0ZWQgYnkgPSA1XG5kZWxldGVkIGJ5ID0gbmlsXG5pZCA9IDJcbmJhbGFuY2U9NTAwDQoNCg0K7LKg7IiYIC0+IOqzhOyijDE6IHNlbGVjdCBiYWxhbmNlIGZyb20gYWNjb3VudHMgZnJvbSBpZCA9IDENCmFjdGl2YXRlIOyyoOyImA0K6rOE7KKMMSAtPiDssqDsiJg6IDUwMA0KDQoNCuyYgeyLneydtCAtPiDqs4TsoowxOiB1cGRhdGUgYWNjb3VudHMgc2V0IGJhbGFuY2UgPSBiYWxhbmNlICsgMTAwIHdoZXJlIGlkID0gMQ0KYWN0aXZhdGUg7JiB7Iud7J20DQrqs4TsoowxIC0+IOyYgeyLneydtDogT0sNCm5vdGUgbGVmdCBvZiDqs4TsoowxOiAqKuqzhOyijDEg7Iqk64OF7IO3Kipcbi0gLVxuY3JlYXRlZCBieSA9IDNcbmRlbGV0ZWQgYnkgPSAxM1xuaWQgPSAxXG5iYWxhbmNlPTUwMFxuLSAtXG5jcmVhdGVkIGJ5ID0gMTNcbmRlbGV0ZWQgYnkgPSBuaWxcbmlkID0gMVxuYmFsYW5jZT02MDANCg0K7JiB7Iud7J20IC0+IOqzhOyijDI6IHVwZGF0ZSBhY2NvdW50cyBzZXQgYmFsYW5jZSA9IGJhbGFuY2UgLSAxMDAgd2hlcmUgaWQgPSAyDQrqs4TsoowyIC0+IOyYgeyLneydtDogT0sNCmRlYWN0aXZhdGUg7JiB7Iud7J20DQoNCuyyoOyImCAtPiDqs4TsoowyOiBzZWxlY3QgYmFsYW5jZSBmcm9tIGFjY291bnRzIGZyb20gaWQgPSAyDQrqs4TsoowyIC0+IOyyoOyImDogNTAwDQpub3RlIHJpZ2h0IG9mIOqzhOyijDI6ICoq6rOE7KKMMiDsiqTrg4Xsg7cqKlxuLSAtXG5jcmVhdGVkIGJ5ID0gNVxuZGVsZXRlZCBieSA9IDEzXG5pZCA9IDJcbmJhbGFuY2U9NTAwXG4tIC1cbmNyZWF0ZWQgYnkgPSAxM1xuZGVsZXRlZCBieSA9IG5pbFxuaWQ9MlxuYmFsYW5jZT00MDANCg0KZGVhY3RpdmF0ZSDssqDsiJgNCkBlbmR1bWwNCgpQbGFudFVNTCB2ZXJzaW9uIDEuMjAyMS4xMGJldGEyKFVua25vd24gY29tcGlsZSB0aW1lKQooR1BMIHNvdXJjZSBkaXN0cmlidXRpb24pCkphdmEgUnVudGltZTogSmF2YShUTSkgU0UgUnVudGltZSBFbnZpcm9ubWVudApKVk06IEphdmEgSG90U3BvdChUTSkgNjQtQml0IFNlcnZlciBWTQpEZWZhdWx0IEVuY29kaW5nOiBVVEYtOApMYW5ndWFnZTogZW4KQ291bnRyeTogVVMKLS0+PC9nPjwvc3ZnPg=='>

<h4 id="일관된-스냅샷을-보는-가시성-규칙"><a href="#일관된-스냅샷을-보는-가시성-규칙" class="headerlink" title="일관된 스냅샷을 보는 가시성 규칙"></a>일관된 스냅샷을 보는 가시성 규칙</h4><ul>
<li>트랜잭션은 데이터베이스에서 객체를 읽을 떄 트랜잭션 ID를 사용해 어떤 것을 볼 수 있고 어떤 것을 볼 수 없는지를 결정</li>
<li>면밀한 가시성 규칙을 정의함으로써 데이터베이스는 데이터베이스의 일관된 스냅샷을 애플리케이션에 제공할 수 있음<ul>
<li>각 트랜잭션을 시작할 때 그 시점에 진행 중인 트랜잭션 목록을 만들고 해당 트랜잭션들이 쓰는 데이터는 모두 무시</li>
<li>트랜잭션 ID가 더 큰 트랜잭션이 쓴 데이터는 그 트랜잭션 커밋 여부와 무관하게 모두 무시</li>
<li>위 조건 외 모든 데이터는 쿼리를 통하여 볼수 있음</li>
</ul>
</li>
<li>데이터베이스는 갱신할 때 값을 교체하지 않고 값이 바뀔 때마다 새 버전을 생성함으로써 작은 오버헤드만 유발하면서 일관된 스냅샷을 제공</li>
</ul>
<h4 id="색인과-스냅샷-격리"><a href="#색인과-스냅샷-격리" class="headerlink" title="색인과 스냅샷 격리"></a>색인과 스냅샷 격리</h4><ul>
<li>색인이 객체의 모든 버전을 가리키게 하고 색인 질의가 현재 트랜잭션에서 볼 수 없는 버전을 걸래내게 하는 것이 일반적인 구현. 하지만, 현실에서는 세부 사항에 따라 MVCC의 성능이 결정됨.<h4 id="반복-읽기와-혼란스러운-이름"><a href="#반복-읽기와-혼란스러운-이름" class="headerlink" title="반복 읽기와 혼란스러운 이름"></a>반복 읽기와 혼란스러운 이름</h4></li>
<li>스냅샷 격리는 읽기 전용 트랜잭션에 유용하며 오라클에서는 <code>직렬성</code>, PostgreSQL과 MySQL에서는 <code>반복읽기(Repreatable Read)</code>라고 부른다</li>
<li><em><strong>이름이 혼란스러운 이유는 SQL 표준에 스냅샷 격리가 존재하지 않기 때문이다.</strong></em> 대신 비슷한 반복 읽기는 SQL 표준에 정의되어 있다.</li>
</ul>
<h3 id="갱신-손실-방지"><a href="#갱신-손실-방지" class="headerlink" title="갱신 손실 방지"></a>갱신 손실 방지</h3><ul>
<li>동시에 실행되는 쓰기 트랜잭션 사이에 발생할 수 있는 흥미로운 종류의 충돌이 몇 가지 더 있는데 가장 널리 알려진 것은 <code>갱신손실(lost update)</code>이다.</li>
<li>갱신 손실 문제는 어플리케이션이 데이터베이스에서 값을 읽고 변경한 후 변경된 값을 다시 쓸 떄(read-modify-write 주기) 발생할 수 있다.<ul>
<li>카운터를 증가시키거나 계좌 잔고를 갱신할때</li>
<li>복잡한 값을 지역적으로 변경할 떄</li>
<li>사용자가 편집한 내용을 저장할 때 전체 페이지 내용을 서버에 보내서 현재 데이터베이스에 저장된 내용을 덮어 쓰도록 만들어진 위키에서 두 명의 사용자가 동시에 같은 페이지를 편집할 때<h4 id="원자적-쓰기-연산"><a href="#원자적-쓰기-연산" class="headerlink" title="원자적 쓰기 연산"></a>원자적 쓰기 연산</h4></li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE counters <span class="keyword">SET</span> <span class="keyword">value</span> <span class="operator">=</span> <span class="keyword">value</span> <span class="operator">+</span> <span class="number">1</span> <span class="keyword">WHERE</span> key <span class="operator">=</span> `foo`;</span><br></pre></td></tr></table></figure>

<ul>
<li>데이터베이스가 제공하는 원자적 연산을 사용하면 보통 객체를 읽을 때 독점적인(exclusive) 잠금을 획득하여 구현하기 때문에 다른 트랜잭션에서 그 객체를 읽지 못하게 된다. 다른 말로 커서 안정선(cursor stability)라고 한다. 다른 선택지로 모든 원자적 연산을 단일 스레드에서 실행하도록 강제하는 것이 있다.</li>
<li>ORM 구현체를 사용하면 보통 원자적 연산을 사용하지 못하고 read-modify-write 주기로 실행하는 경우가 많다. 이럴 경우 아래에서 설명하는 <code>명시적인 잠금</code>을 활용하는 방법이 좋다.</li>
</ul>
<h4 id="명시적인-잠금"><a href="#명시적인-잠금" class="headerlink" title="명시적인 잠금"></a>명시적인 잠금</h4><ul>
<li>어플리케이션에서 갱신할 객체를 명시적으로 잠그는 것. <code>read-modify-write</code> 주기에서 사용할 경우 다른 트랜재겻ㄴ에 동시에 같은 객체를 읽으려고 하면 먼저 실행한 트랜잭션의 <code>read-modify-write</code>이 종료될 떄까지 기다리도록 강제할 수 있다.</li>
</ul>
<h4 id="갱신-손실-자동-감지"><a href="#갱신-손실-자동-감지" class="headerlink" title="갱신 손실 자동 감지"></a>갱신 손실 자동 감지</h4><ul>
<li>원자적 연산과 잠금은 <code>read-modify-write</code> 주기가 순차적으로 실행되도록 강제함으로써 갱신 손실을 방지하는 기법인데, 대안으로 이들의 병렬 실행을 허용하고 트랜잭션 관리자가 갱신 손실이 발생하면 트랜잭션을 어보트시키고 read-modify-write 주기를 재시도하도록 강제하는 방법이 있다.</li>
<li>PostgreSQL의 Repeatable Read, Oracle의 Serialiable, SQL 서버의 스냅샷 격리 수준은 갱신 손실이 발생하면 자동으로 발견해서 문제가 되는 트랜잭션을 어보트시킨다. 하지만, MySQL InnoDB의 Repetable-Read의 경우 갱신 손실을 감지하지 않는다.</li>
</ul>
<h4 id="Compare-And-Set"><a href="#Compare-And-Set" class="headerlink" title="Compare-And-Set"></a>Compare-And-Set</h4><ul>
<li>Compare-And-Set 연산의 목적은 값을 마지막으로 읽은 후 변경되지 않았을 때만 갱신을 허용함으로써 갱신 손실을 회피하는 방법이다. 다시 말해, 아래 예제처럼 old content와 일치하지 않으면 값을 갱신하지 않는다. 하지만 <em><strong>오래된 스냅샷에서 값을 읽어오는 경우 이 구문은 갱신 손실을 막아주지 못한다.</strong></em><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- DB 구현에 따라 안전할수도/그렇지 않을 수 있다고 함.</span></span><br><span class="line">UPDATE wiki_pages <span class="keyword">SET</span> content <span class="operator">=</span> <span class="string">&#x27;new content&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1234</span> <span class="keyword">and</span> content <span class="operator">=</span> <span class="string">&#x27;old content&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="출동-해소와-복제"><a href="#출동-해소와-복제" class="headerlink" title="출동 해소와 복제"></a>출동 해소와 복제</h4><ul>
<li>복제가 적용된 데이터베이스에서 갱신 손실을 막는건 또 다른 차원의 문제로 데이터가 다른 노드들에서 동시에 변경될 수 있으므로 갱신 손실을 막기 위해서는 추가적인 단계가 필요하다. </li>
<li><strong>복제가 적용된 데이터베이스에서 흔히 사용하는 방법으로 쓰기가 동시에 실행될 때 한 값에 대해 여러 개의 충돌된 버젼 생성을 허용하고 사후에 어플리케이션 코드가 다양한 데이터 구조를 활용하여 충돌을 해소하고 이 여러 버젼을 병합하는 방법을 사용한다.</strong></li>
<li>원자적 연산은 복제가 적용된 상황에서도 유용하며 특히 교환법칙(순서를 앞뒤로 바꿔서 해도 동일할 경우)이 성립하는 경우라면 그렇다.</li>
<li>최종 쓰기 승리(last write wins, LWW) 충돌 해소 방법은 갱신 손실 발생이 쉽다.</li>
</ul>
<h3 id="쓰기-스큐와-팬텀"><a href="#쓰기-스큐와-팬텀" class="headerlink" title="쓰기 스큐와 팬텀"></a>쓰기 스큐와 팬텀</h3><ul>
<li>동시에 실행되는 쓰기 작업 사이에 잠재적으로 발생할 수 있는 경쟁조건은 <code>더티 쓰기</code>, <code>갱신 손실</code> 말고도 더 존재한다. 특히 쓰기 스큐(write skew)가 대표적인 예이다.</li>
</ul>
<h4 id="쓰기-스큐를-특정짓기"><a href="#쓰기-스큐를-특정짓기" class="headerlink" title="쓰기 스큐를 특정짓기"></a>쓰기 스큐를 특정짓기</h4><ul>
<li>두 트랜잭션이 같은 트랜잭션을 읽어서 그중 일부를 갱신할 떄 나타날 수 있는 현상. 같은 객체에 쓰는 것이 아니기 때문에 더티 쓰기도 경신 이상도 아니다.</li>
<li>다른 트랜잭션이 하나의 동일한 객체를 갱신하는 경우라면 타이밍에 따라 더티 쓰기, 갱신 손실 이상을 경험하고 다른 객체에 해당하는 경우는 쓰기 스큐를 경험할 수도 있다.</li>
<li>앞에서 소개한 원자적 연산과 갱신 손실 자동 감지와 같은 기능도 이러한 쓰기 스큐 상황에서는 도움이 되지 않고, 이런 문제를 해결하는 차선의 방법으론 아래와 같이 읽는 시점에 잠금을 활용한 직렬성 격리 수준을 활용할 수도 있다. </li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> doctors</span><br><span class="line"><span class="keyword">WHERE</span> on_call <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">AND</span> shift_id <span class="operator">=</span> <span class="number">1234</span> <span class="keyword">FOR</span> UPDATE;</span><br><span class="line"></span><br><span class="line">UPDATE doctors</span><br><span class="line"><span class="keyword">SET</span> on_call <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line"><span class="keyword">WHERE</span> name <span class="operator">=</span> `Alice`</span><br><span class="line"><span class="keyword">AND</span> shift_id <span class="operator">=</span> <span class="number">1234</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>아래와 같은 상황에서 까다로운 쓰기 스큐를 케이스를 접할 수도 있다.<ul>
<li>회의실 예약 시스템</li>
<li>사용자명 획득</li>
<li>이중 사용 방지</li>
</ul>
</li>
</ul>
<h4 id="쓰기-스큐를-유발하는-패턴"><a href="#쓰기-스큐를-유발하는-패턴" class="headerlink" title="쓰기 스큐를 유발하는 패턴"></a>쓰기 스큐를 유발하는 패턴</h4><ul>
<li>어떤 트랜잭션에서 실행한 쓰기가 다른 트랜잭션의 검색 질의 결과를 바꾸는 효과를 팬텀(phantom)이라고 한다. 스냅샷 격리는 읽기 전용 질의에서는 팬텀을 회피하지만 읽기 쓰기 트랜잭션에서는 팬텀이 쓰기 스큐의 특히 까다로운 경우를 유발할 수 있다.</li>
</ul>
<h4 id="충돌-구체화"><a href="#충돌-구체화" class="headerlink" title="충돌 구체화"></a>충돌 구체화</h4><ul>
<li>충돌 구체화(Materializing Conflict)는 팬텀이 발생할 수 있는 데이터베이스 구체적인 로우 집합에 대해 잠금으로 변환하여 해당 로우를 잠궈 생길 수 있는 팬텀 상황을 방지하는 기법이다.(인위적으로 데이터베이스에 잠금 객체를 추가) 회의실 예약과 같은 도메인 상황에서는 회의실 예약 시간 슬롯 혹은 회의실에 대한 테이블을 별도로 만들어두는 방법을 생각할 수 있다.</li>
<li>충돌 구체화는 동시성 제어 모델이 어플리케이션 데이터 모델로 세어나오기 때문에 보기가 좋지 않으며 해결할 수 있는 방법이 없는 경우 최우의 수단으로 활용하며 대부분 이런 경우 직렬성 격리 수준을 사용하는 것이 나을 수 있다.</li>
</ul>
<h2 id="직렬성"><a href="#직렬성" class="headerlink" title="직렬성"></a>직렬성</h2><ul>
<li>직렬성 격리를 사용해야 한다면?<ul>
<li>격리 수준은 이해하기 어렵고 데이터베이스마다 그 구현에 일관성이 없음</li>
<li>어플리케이션 코드를 보고 특정한 격리 수준에서 해당 코드를 실행하는게 안전한지 알기 어렵다.</li>
<li>경쟁 조건을 감지하는 데 도움이 되는 좋은 도구가 없다.</li>
</ul>
</li>
<li>직렬성 격리는 보통 가장 강력한 격리 수준이라고 여겨진다. 여러 트랜잭션이 병렬로 실행되더라도 최종 결과는 동시성 없이 한 번에 하나씩 직렬로 실행될 떄와 같도록 보장한다.</li>
<li>직렬성을 구현하는 선택지는?<ul>
<li>트랜잭션을 순차적으로 실행</li>
<li>2단계 잠금</li>
<li>직렬성 스냅샷 격리(냑관적 동시 제어)</li>
</ul>
</li>
</ul>
<h3 id="실제적인-직렬-실행"><a href="#실제적인-직렬-실행" class="headerlink" title="실제적인 직렬 실행"></a>실제적인 직렬 실행</h3><ul>
<li>데이터베이스 설계자들은 상당히 최근(2007)이 돼서야 단일 스레드루프에서 트랜잭션을 실행하는 게 실현 가능하다는 결론을 내렸다고 함.</li>
<li>잠금을 코디네이션하는 등의 오버헤드를 피하기 때문에 단일 스레드로 실행되도록 설계된 시스템이 동시성을 지원하는 시스템보다 성능이 나을 떄도 있다. 대신 이들의 처리량은 CPU 코어 하나의 처리량으로 제한된다.</li>
</ul>
<h4 id="트랜잭션을-스토어드-프로시저-안에-캡슐화하기"><a href="#트랜잭션을-스토어드-프로시저-안에-캡슐화하기" class="headerlink" title="트랜잭션을 스토어드 프로시저 안에 캡슐화하기"></a>트랜잭션을 스토어드 프로시저 안에 캡슐화하기</h4><ul>
<li>데이터베이스 초창기에는 사용자의 전체 흐름을 하나의 트랜잭션으로 묶는 시도도 있었으나 사람의 결정은 느리기 때문에 이는 곧 유효한 방법이 아니었으며 대부분 대화식으로 사용자 응답을 대기 하는 것을 회피하고 트랜잭션을 짧게 유지한다. 웹의 경우 하나의 Http Request가 하나의 트랜잭션을 처리하는 방식을 사용 다시 말해 한 번에 구문 하나씩 실행하는 방식이다.</li>
<li>단일 스레드에서 트랜잭션을 순차적으로 처리하는 시스템들은 상호작용하는 다중 구문 트랜잭션을 허용하지 않고 대신 애플리케이션은 트랜잭션 전체 코드를 스토어드 프로시저 형태로 데이터베이스에 미리 제출해야 한다.<h4 id="스토어드-프로시저의-장단점"><a href="#스토어드-프로시저의-장단점" class="headerlink" title="스토어드 프로시저의 장단점"></a>스토어드 프로시저의 장단점</h4></li>
<li>데이터베이스 벤더마다 제각각 스토어드 프로시저용 언어가 존재</li>
<li>데이터베이스에서 실행되는 코드는 관리가 어렵다(디버깅/버젼관리/배포/모니터링)</li>
<li><em><strong>데이터베이스는 어플리케이션 서버보다 훨씬 더 성능에 민감할 떄가 많다.</strong></em></li>
<li>현대의 스토어드 프로시저 구현은 데이터베이스 벤더 종속적인 언어(PL/SQL)들을 버리고 범용 프로그래밍 언어(Java, Lua, Groovy)등을 사용한다.<blockquote>
<p>스토어드 프로시저가 있고 데이터가 메모리에 저장된다면 모든 트랜잭션을 단일 스레드에서 실행하는게 현실성 있을 수 있다. I/O 대기가 필요 없고 다른 동시성 제어 메커니즘의 오버헤드를 회피하므로 상당히 좋은 처리량을 얻을 수 있다.</p>
</blockquote>
</li>
</ul>
<h4 id="파티셔닝"><a href="#파티셔닝" class="headerlink" title="파티셔닝"></a>파티셔닝</h4><ul>
<li>모든 트랜잭션을 순차적으로 실행하면 동시성 제어는 훨씬 간단해진다. 하지만 데이터베이스 처리량이 단일 장비에 있는 단일 CPU 코어의 속도로 제한된다. 쓰기 처리량이 높은 어플리케이션에게는 단일 스레드 트랜잭션 처리자가 심각한 병목이 될 수 있다.</li>
<li><em><strong>여러 CPU 코어와 여러 노드로 확장하기 위해 데이터를 파티셔닝할 수도 있다.</strong></em> 각 트랜잭션이 단일 파티션 내에서만 데이터를 읽고 쓰도록 데이터셋을 파티셔닝 할 수 있다면 각 파티션은 다른 파티션과 독립적으로 실행되는 자신만의 트랜잭션 처리 스레드를 가질 수 있다. 이 경우 각 CPU 코어에 각자의 파티션을 할당해 트랜잭션 처리량을 CPU 코어 개수에 맞춰 선형적으로 확장할 수 있다. 하지만, 여러 파티션에 접근해야 하는 트랜잭션이 있다면 데이터베이스가 해당 트랜잭션이 접근하는 모든 파티션에 걸쳐서 코디네이션 해야 하기 때문에 시스템에 걸친 직렬성 보장을 위해 모든 파티션에 걸쳐 잠금을 획득한 단계에서 실행돼야 한다. 추가적인 오버헤드가 있으므로 단일 파티션 트랜잭션보다 엄청 느리다.</li>
</ul>
<h4 id="직렬-실행-요약"><a href="#직렬-실행-요약" class="headerlink" title="직렬 실행 요약"></a>직렬 실행 요약</h4><ul>
<li>트랜잭션 직렬 실행은 몇 가지 제약 사항 안에서 직렬성 격리를 획득하는 실용적인 방법이 될 수 있다.<ul>
<li>TX가 작고 빨라야 한다.</li>
<li>쓰기 처리량이 단일 CPU 코어에서 처리할 수 있을 정도로 충분히 낮아야 한다. 여러 파티션에 걸친 코디네이션이 필요하지 않도록 트랜잭션을 파티셔닝 해야 한다.</li>
</ul>
</li>
</ul>
<h3 id="2단계-잠금"><a href="#2단계-잠금" class="headerlink" title="2단계 잠금"></a>2단계 잠금</h3><ul>
<li>직렬성을 구현하는데 널리 쓰이는 유일한 알고리즘</li>
<li>두 개의 트랜잭션이 동시에 같은 객체에 쓰려고 하면 잠금은 나중에 쓰는 쪽이 진행하기 전에 먼저 쓰는 쪽에서 트랜잭션을 완료(어보트/커밋)할 떄까지 기다리도록 보장해준다. 잠금 요구사항이 훨씬 강하고 쓰기를 실행하는 트랜잭션이 없으면(읽기 전용) 여러 트랜잭션에서 동시에 읽을 수 잇지만 누군가 어떤 객체에 쓰려고(변경/삭제) 하면 독점적인 접근이 필요하다.</li>
</ul>
<blockquote>
<p>2PL은 2PC가 아니다<br>2단계 잠금과 2단계 커밋은 비슷하게 들리지만 완전히 다.르.다.</p>
</blockquote>
<ul>
<li>2PL에서 쓰기 트랜잭션은 다르 쓰기 트랜잭션뿐만 아니라 읽기 트랜잭션도 진행하지 못하게 막고 그 역도 성립한다. 2PL은 직렬성을 제공하므로 앞에서 설명한 갱신 손실과 쓰기 스큐를 포함한 모든 경쟁 조건으로부터 보호해준다.</li>
</ul>
<h4 id="2단계-잠금-구현"><a href="#2단계-잠금-구현" class="headerlink" title="2단계 잠금 구현"></a>2단계 잠금 구현</h4><ul>
<li><p><strong>2PL은 MySQL(InnoDB)와 SQL Server에서 Serialiable 격리 수준을 구현하는 데 사용되고</strong> DB2에서는 반복 읽기 격리 수준을 구현하는 데 사용된다.</p>
</li>
<li><p>읽는 쪽/쓰는 쪽을 막는 것은 데이터베이스의 각 객체에 잠금을 사용해 구현. 잠금은 공유 모드(shared mode)와 독점 모드(exclusive mode)로 사용될 수 있다.</p>
<ul>
<li>트랜잭션이 객체를 읽기 원한다면 먼저 공유 모드로 잠금을 획득해야 한다.</li>
<li>트랜잭션이 객체에 쓰기를 원한다면 먼저 독점 모드로 잠금을 획득해야 한다.</li>
<li>트랜잭션이 객체를 읽다가 쓰기를 실행할 때는 공유 잠금을 독점 잠금으로 업그레이드 해야 한다.</li>
<li><code>트랜잭션이 잠금을 획득한 후에는 트랜잭션이 종료(커밋/어보트)될 떄까지 잠금을 갖고 있어야 한다.</code> 첫 번째 단계는 잠금을 획득할 때이고 두 번쨰 단계는 모든 잠금을 헤제할 떄다. 그래서 2단계 라는 이름이 붙었다.</li>
</ul>
</li>
<li><p>TX-A가 TX-B의 잠금을 헤제하기를 기다리고 멈춰 있고 TX-B가 TX-A가 잠금을 헤제하기를 기다리고 멈춰 있는 상황을 <code>데드락(교착상태)</code>라고 부른다. 이럴 경우 데이터베이스는 해당 상황을 감지하고 하나를 어보트시켜서 다른 트랜잭션들이 실행할 수 있도록 진행해야 한다. 어보트된 트랜잭션을 재시도 해야 한다.</p>
</li>
</ul>
<h4 id="2단계-잠금의-성능"><a href="#2단계-잠금의-성능" class="headerlink" title="2단계 잠금의 성능"></a>2단계 잠금의 성능</h4><ul>
<li>2PL을 사용하면 완화된 격리 수준을 쓸 때보다 트랜잭션 처리량과 질의 응답 시간이 크게 나빠진다.</li>
<li>잠금을 획득하고 헤제하는 오버헤드도 문제지만, 더 큰 원인은 동시성이 줄어드는 것이다. 설계에 따라 두 트랜잭션이 어떤 식으로든 경쟁 조건을 유발하는 일을 하려고 하면 한 트랜잭션은 다른 트랜잭션이 완료될 때까지 기다려야 한다.</li>
<li>전통적인 데이터베이스들은 트랜잭션 시간에 제한이 없다.(대부분 상호작용 어플리케이션을 위해 설계되었기 때문) 그래서 한 트랜잭션이 다른 트랜잭션이 끝나기를 기다릴 때 얼마나 오래 기다려야 하는지에 대한 제한이 없다. <strong>모든 트랜잭션의 실행 시간을 짧게 유지하는 확실한 방법이 있더라도 여러 트랜잭션이 같은 객체에 접근하려고 하면 대기열이 생겨서 트랜잭션이 뭔가를 하려면 여러 다른 트랜잭션들이 완료되기를 기다려야 할 수도 있다.</strong></li>
<li>잠금 기반의 커밋 후 읽기(READ_COMMITTED)에서도 교착 상태가 생길 수 있지만 2PL 직렬성 격리에서는 훨씬 더 자주 발생할 수 있다.</li>
</ul>
<h4 id="서술-잠금-Predicate-Lock"><a href="#서술-잠금-Predicate-Lock" class="headerlink" title="서술 잠금(Predicate Lock)"></a>서술 잠금(Predicate Lock)</h4><ul>
<li><p>공유/독점 잠금과 비슷하게 동작하지만 특정 객체(예를 들어 테이블 내의 한 로우)에 속하지 않고 아래와 같은 어떤 검색 조건에 부합하는 모든 객체에 속한다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> bookings</span><br><span class="line"><span class="keyword">WHERE</span> room_id <span class="operator">=</span> <span class="number">123</span> </span><br><span class="line"><span class="keyword">AND</span> end_time <span class="operator">&gt;</span> <span class="string">&#x27;2018-01-01 12:00&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> start_time <span class="operator">&gt;</span> <span class="string">&#x27;2018-01-01 13:00&#x27;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>트랜잭션 A가 조건에 부합하는 객체를 읽기 원한다면 질의의 조건에 대한 <strong>공뮤 모드 서술 잠금</strong>을 획득해야 한다. 다른 트랜잭션 B가 그 조건에 부합하는 어떤 객체에 <strong>독점 잠금</strong>을 갖고 있으면 A는 질의를 실행하도록 허용되기 전에 B가 잠금을 해제하기를 기다려야 한다.</li>
<li>다른 트랜잭션 B가 해당하는 서술 잠금을 가지고 있는 상태에서 트랜잭션 A가 객체를 삽입/갱신/삭제를 원한다면 B가 트랜잭션을 커밋/어보트할때까지 A는 기다려야 한다.</li>
</ul>
</blockquote>
</li>
<li><p>2PL이 서술 잠금을 포함하면 데이터베이스에서 모든 형태의 쓰기 스큐와 다른 경쟁 조건을 막을 수 있어서 격리 수준이 직렬성 격리가 된다.</p>
</li>
</ul>
<h4 id="색인-범위-잠금"><a href="#색인-범위-잠금" class="headerlink" title="색인 범위 잠금"></a>색인 범위 잠금</h4><ul>
<li><p>진행 중인 트랜잭션들이 획득한 잠금이 많으면 조건에 부합하는 잠금을 확인하는 데 시간이 오래 걸리기 때문에 서술 잠금은 잘 동작하지 않는다.</p>
</li>
<li><p>실제로 대부분의 데이터베이스는 **색인 범위 잠금(index-range locking, 다음 키 잠금(next-key locking)이라고도 함)**을 구현한다. 서술 잠금을 간략하게 근사한 것이다.(더 많은 객체가 부합하도록 서술 조건을 간략화하는 것은 안전하다.)</p>
</li>
<li><p>회의실 예약을 예로 들면 회의실 고유키인 room_id가 있고 회의실 예약 시간을 표현하는 start_time, end_time가 있다고 하자. 여기서 room_id에만 색인이 있을 수 있고 아니면 start_time 혹은 end_time에만 색인이 있을 수 있다.</p>
<ul>
<li>room_id에 색인이 있고 DB에서 123번 방에 예약이 있는지 확인하는 데에 이 색인을 사용한다. DB는 이 색인 항목에 공유 잠금을 잡아서 트랜잭션이 123번 방에 대한 예약을 검색했다고 표시할수 있다.</li>
<li>시간 기반 색인(start_time, end_time)을 사용한다면 그 색인에 있는 값들의 범위에 공유 잠금을 잡아서 트랜잭션이 특정 시간대에 있는 예약을 검색했다고 표시할 수 있다.</li>
</ul>
</li>
<li><p>색인 기반의 잠금은 서술 잠금보다 정확하진 않지만(필요 이상의 큰 범위를 잠글수도 있음) 오버헤드가 적기 때문에 좋은 타협안이 될 수 있다. 범위 잠금을 잡을 수 있는 적합한 색인이 없다면 데이터베이스는 테이블 전체에 공유 잠금을 잡는 것으로 대체할 수 있다. 그 테이블에 쓰는 다른 모든 트랜잭션을 멈추므로 성능에는 좋지 않지만 안전한 대비책이다.</p>
</li>
</ul>
<h3 id="직렬성-스냅샷-격리-SSI"><a href="#직렬성-스냅샷-격리-SSI" class="headerlink" title="직렬성 스냅샷 격리(SSI)"></a>직렬성 스냅샷 격리(SSI)</h3><h4 id="비관성-동시성-제어와-낙관적-동시성-제어"><a href="#비관성-동시성-제어와-낙관적-동시성-제어" class="headerlink" title="비관성 동시성 제어와 낙관적 동시성 제어"></a>비관성 동시성 제어와 낙관적 동시성 제어</h4><h4 id="뒤쳐진-전제에-기반한-결정"><a href="#뒤쳐진-전제에-기반한-결정" class="headerlink" title="뒤쳐진 전제에 기반한 결정"></a>뒤쳐진 전제에 기반한 결정</h4><h4 id="오래된-MVCC-읽기-감지하기"><a href="#오래된-MVCC-읽기-감지하기" class="headerlink" title="오래된 MVCC 읽기 감지하기"></a>오래된 MVCC 읽기 감지하기</h4><h4 id="과거의-읽기에-영향을-미치는-쓰기-감지하기"><a href="#과거의-읽기에-영향을-미치는-쓰기-감지하기" class="headerlink" title="과거의 읽기에 영향을 미치는 쓰기 감지하기"></a>과거의 읽기에 영향을 미치는 쓰기 감지하기</h4><h4 id="직렬성-스냅샷-격리의-성능"><a href="#직렬성-스냅샷-격리의-성능" class="headerlink" title="직렬성 스냅샷 격리의 성능"></a>직렬성 스냅샷 격리의 성능</h4><h2 id="정리"><a href="#정리" class="headerlink" title="정리"></a>정리</h2></div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2021/08/13/DIARY/20210813/">20210813</a><a class="next" href="/2021/08/08/DIARY/20210808/">20210808</a></div><script src="https://utteranc.es/client.js" repo="thefeeling/thefeeling.github.io" issue-term="title" theme="github-light" crossorigin="anonymous" async> </script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://thefeeling.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 카테고리</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ARCHITECTURE/">ARCHITECTURE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/AWS/">AWS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CS/">CS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DATABASE/">DATABASE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DDD/">DDD</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DIARY/">DIARY</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTTP/">HTTP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kotlin/">Kotlin</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MESSAGING/">MESSAGING</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Persistence/">Persistence</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 태그</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 과거</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/08/13/DIARY/20210813/">20210813</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/09/ARCHITECTURE/DATA_INTENSIVE_APPLICATION/">데이터 중심 어플리케이션 설계 - 7장 트랜잭션</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/08/DIARY/20210808/">20210808</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/05/DIARY/20210805/">20210805</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/01/DIARY/20210801/">20210801</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/07/30/DIARY/20210730/">20210730</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/07/28/DIARY/20210728/">20210728</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/07/27/DIARY/20210727/">20210727</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/07/27/Spring/MVC_RequestParam/">MVC와 WebFlux에서의 @ReqeustParam</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/07/27/Kotlin/Kotlin_In_Action/">Kotlin-In-Action Generics</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">Choi's Dev.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" id="maid-script" mermaidoptioins="{&quot;startOnload&quot;:true}" src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js?v=1.0.0"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize(options);
}
</script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>